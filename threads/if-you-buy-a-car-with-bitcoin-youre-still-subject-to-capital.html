<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üßµif you buy a car with Bitcoin, you&#x27;re still subject to capital gains tax</title>
    
    <meta property="og:title" content="üßµif you buy a car with Bitcoin, you're still subject to capital gains tax" />
    <meta property="og:type" content='article' />
    <meta property="og:url" content='https://illya.sh/threads/if-you-buy-a-car-with-bitcoin-youre-still-subject-to-capital' />
    <meta property="og:image" content='https://illya.sh/staticthoughts/data/images/if-you-buy-a-car-with-bitcoin-youre-still-subject-to-capital.jpg' />
    <meta property="og:description" content="under the US law cryptocurrencies are property - so you're taxed on the USD value of the car at the time of purchase minus the cost of your original crypto purchase (so you're only taxed on the g..." />
    <meta property="og:site_name" content="Illya's Finance, Crypto & Macro Thoughts" />
    <meta name="twitter:card" content='summary_large_image' />
    <meta name="twitter:title" content="üßµif you buy a car with Bitcoin, you're still subject to capital gains tax" />
    <meta name="twitter:description" content="under the US law cryptocurrencies are property - so you're taxed on the USD value of the car at the time of purchase minus the cost of your original crypto purchase (so you're only taxed on the g..." />
    <meta name="twitter:image" content='https://illya.sh/staticthoughts/data/images/if-you-buy-a-car-with-bitcoin-youre-still-subject-to-capital.jpg' />
    <link rel="alternate" type="application/rss+xml" title="Illya Gerasymchuk Threads RSS" href="https://illya.sh/threads/feed.xml"/>
    <link rel="alternate" type="application/rss+xml" title="Illya Gerasymchuk Thoughts RSS" href="https://illya.sh/thoughts/feed.xml"/>
    
    <script type="application/ld+json">
{"@context": "https://schema.org", "@graph": [{"@type": "Person", "name": "Illya Gerasymchuk", "url": "https://illya.sh/"}, {"@type": "Article", "headline": "if you buy a car with Bitcoin, you're still subject to capital gains tax", "articleBody": "under the US law cryptocurrencies are property - so you're taxed on the USD value of the car at the time of purchase minus the cost of your original crypto purchase (so you're only taxed on the gain/profit)\n\nso if the processing fee of a payment with Ethereum is larger than it would be by selling Ethereum for USD first (e.g. transfer ETH to an exchange --> sell --> transfer to your bank account), then you end up paying more with Ethereum than you would with USD. it make sense, because you'd be removing an intermediary (i.e. you sell ETH for USD yourself)\n\nin either case, the seller receives USD for the car, not ETH or BTC. the intermediary most likely doesn't keep ETH/BTC on their balance sheet either, they just proxy your order to the market and charge a spread", "author": {"@type": "Person", "name": "Illya Gerasymchuk", "url": "https://illya.sh/"}, "publisher": {"@type": "Person", "name": "Illya Gerasymchuk", "url": "https://illya.sh/threads/"}, "url": "https://illya.sh/threads/if-you-buy-a-car-with-bitcoin-youre-still-subject-to-capital", "mainEntityOfPage": "https://illya.sh/threads/if-you-buy-a-car-with-bitcoin-youre-still-subject-to-capital", "datePublished": "2025-09-28T17:07:07+00:00", "dateModified": "2025-09-28T17:07:07+00:00", "keywords": "crypto, finance, law, AI, software development, economics, blockchain, markets", "image": "https://illya.sh/staticthoughts/data/images/if-you-buy-a-car-with-bitcoin-youre-still-subject-to-capital.jpg"}]}
</script>
    
    <style>
        /* Shared base layout + profile header styles.
   Injected into templates via BASE_LAYOUT_AND_PROFILE_CSS placeholder. */

:root {
    /* Light Theme Variables */
    --bg-color: #f4f4f4;
    --container-bg: #ffffff;
    --box-bg: #fff;
    --text-color: #333;
    --secondary-text-color: #555;
    --light-text-color: #666;
    --link-color: #007bff;
    --link-hover-color: #0056b3;
    --border-color: #ddd;
    --soft-border-color: #eee;
    --dashed-border-color: #aaa;
    --box-shadow-color: rgba(0,0,0,0.08);
    --lightbox-bg: rgba(0, 0, 0, 0.9);
    --lightbox-close-bg: rgba(255, 255, 255, 0.8);
    --lightbox-close-hover-bg: rgba(255, 255, 255, 1);
    --lightbox-close-color: #000;
    --disabled-text-color: #aaa;
    --disabled-bg-color: #f9f9f9;
    --hover-bg-color: #eee;
}

/* Dark Theme Variables (applied via media query or body class) */
.dark-mode {
    --bg-color: #1a1a1a; /* Dark grey background */
    --container-bg: #2b2b2b; /* Slightly lighter container */
    --box-bg: #2b2b2b; /* Same as container for profile/thought boxes */
    --text-color: #e0e0e0; /* Light grey text */
    --secondary-text-color: #b0b0b0; /* Medium grey */
    --light-text-color: #999; /* Lighter grey for dates etc. */
    --link-color: #58a6ff; /* Lighter blue for links */
    --link-hover-color: #80bfff; /* Even lighter blue on hover */
    --border-color: #444; /* Darker border */
    --soft-border-color: #333; /* Even darker soft border */
    --dashed-border-color: #666; /* Darker dashed border */
    --box-shadow-color: rgba(255,255,255,0.08); /* Light shadow */
    --lightbox-bg: rgba(0, 0, 0, 0.95); /* Slightly more opaque */
    --lightbox-close-bg: rgba(50, 50, 50, 0.8);
    --lightbox-close-hover-bg: rgba(70, 70, 70, 1);
    --lightbox-close-color: #eee;
    --disabled-text-color: #777;
    --disabled-bg-color: #3a3a3a;
    --hover-bg-color: #383838;
}

/* Apply dark mode based on system preference */
@media (prefers-color-scheme: dark) {
    :root {
        /* Default to dark variables if system preference is dark */
        /* This will be overridden if .light-mode is explicitly set */
        --bg-color: #1a1a1a;
        --container-bg: #2b2b2b;
        --box-bg: #2b2b2b;
        --text-color: #e0e0e0;
        --secondary-text-color: #b0b0b0;
        --light-text-color: #999;
        --link-color: #58a6ff;
        --link-hover-color: #80bfff;
        --border-color: #444;
        --soft-border-color: #333;
        --dashed-border-color: #666;
        --box-shadow-color: rgba(255,255,255,0.08);
        --lightbox-bg: rgba(0, 0, 0, 0.95);
        --lightbox-close-bg: rgba(50, 50, 50, 0.8);
        --lightbox-close-hover-bg: rgba(70, 70, 70, 1);
        --lightbox-close-color: #eee;
        --disabled-text-color: #777;
        --disabled-bg-color: #3a3a3a;
        --hover-bg-color: #383838;
    }

    /* Ensure explicit light mode overrides system pref */
    .light-mode {
        --bg-color: #f4f4f4;
        --container-bg: #ffffff;
        --box-bg: #fff;
        --text-color: #333;
        --secondary-text-color: #555;
        --light-text-color: #666;
        --link-color: #007bff;
        --link-hover-color: #0056b3;
        --border-color: #ddd;
        --soft-border-color: #eee;
        --dashed-border-color: #aaa;
        --box-shadow-color: rgba(0,0,0,0.08);
        --lightbox-bg: rgba(0, 0, 0, 0.9);
        --lightbox-close-bg: rgba(255, 255, 255, 0.8);
        --lightbox-close-hover-bg: rgba(255, 255, 255, 1);
        --lightbox-close-color: #000;
        --disabled-text-color: #aaa;
        --disabled-bg-color: #f9f9f9;
        --hover-bg-color: #eee;
    }
}

/* --- Webfont: Literata (variable, WOFF2) for reading surfaces --- */
@font-face {
    font-family: 'Literata';
    src: url('/staticthoughts/data/fonts/literata/Literata-VF-latin.woff2') format('woff2-variations');
    font-style: normal;
    font-weight: 200 900;
    font-display: swap;
}
@font-face {
    font-family: 'Literata';
    src: url('/staticthoughts/data/fonts/literata/Literata-Italic-VF-latin.woff2') format('woff2-variations');
    font-style: italic;
    font-weight: 200 900;
    font-display: swap;
}

body {
    font-family: "Courier New", Courier, monospace;
    background-color: var(--bg-color); /* USE VAR */
    color: var(--text-color); /* USE VAR - Set default text color */
    margin: 0;
    padding: 20px;
    display: flex;
    justify-content: center;
    transition: background-color 0.3s ease, color 0.3s ease; /* Smooth transition */
}

a {
    color: var(--link-color);
    text-decoration: none; /* Consistent link styling */
    transition: color 0.2s ease;
}
a:hover {
    color: var(--link-hover-color);
    text-decoration: underline; /* Underline on hover for clarity */
}
a:visited {
    color: var(--link-color); /* Ensure visited links use theme color */
}

.container {
    background-color: var(--container-bg); /* USE VAR */
    padding: 25px;
    border: 1px solid var(--border-color); /* USE VAR */
    max-width: 750px;
    width: 100%;
    box-sizing: border-box;
    box-shadow: 0 1px 4px var(--box-shadow-color); /* USE VAR */
    transition: background-color 0.3s ease, border-color 0.3s ease; /* Smooth transition */
}

/* Profile Box Styling */
.profile-box {
    border: 2px dashed var(--dashed-border-color); /* USE VAR */
    padding: 15px;
    margin-bottom: 30px;
    background-color: var(--box-bg); /* USE VAR */
    display: flex;
    flex-direction: column;
    align-items: center;
    transition: background-color 0.3s ease, border-color 0.3s ease; /* Smooth transition */
}
.profile-content {
    display: flex;
    align-items: center;
    justify-content: center;
    margin-bottom: 0; /* Remove vertical spacing */
    width: 100%;
}
.profile-img {
    width: 60px;
    height: 60px;
    border-radius: 50%;
    object-fit: cover;
    margin-right: 15px;
    border: 1px solid var(--soft-border-color); /* USE VAR */
    box-shadow: 0 0 0 4px #00aef5;
    flex-shrink: 0;
    cursor: pointer; /* Theme toggle on thoughts pages */
    transition: border-color 0.3s ease, box-shadow 0.3s ease; /* Smooth transition */
}
.profile-details {
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
}
.profile-name {
    font-weight: bold;
    font-size: 1.2em;
    margin-bottom: 2px;
    color: var(--text-color); /* Ensure uses variable */
}
.profile-title {
    color: var(--secondary-text-color); /* USE VAR */
    font-size: 0.95em;
}
.profile-links {
    font-size: 0.9em;
    color: var(--secondary-text-color); /* USE VAR */
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    align-items: center;
    gap: 8px 16px;
    padding: 0;
    margin-top: 12px;
    line-height: 1.4;
}
.profile-links a {
    text-decoration: none;
    color: var(--link-color); /* USE VAR */
    transition: color 0.2s ease;
    white-space: nowrap;
    padding: 2px 4px;
    border-radius: 3px;
    display: inline-block;
}
.profile-links a:hover {
    color: var(--link-hover-color); /* USE VAR */
    background-color: var(--hover-bg-color);
}

/* Shared responsive */
@media (max-width: 600px) {
    body {
        padding: 10px;
    }
    .container {
        padding: 15px;
        max-width: 100%;
    }
    /* Adjusted Profile Box for Mobile */
    .profile-box {
        padding: 12px; /* Further reduced padding */
        margin-bottom: 25px; /* Further reduced margin */
    }
    /* Adjusted Profile Content for Mobile */
    .profile-content {
        align-items: center;
        justify-content: center;
        margin-bottom: 0; /* No spacing between profile content and links */
    }
    .profile-img {
        width: 50px;
        height: 50px;
        margin-right: 12px;
    }
    .profile-name {
        font-size: 1.1em;
    }
    .profile-title {
        font-size: 0.9em;
    }
    /* Adjusted Profile Links for Mobile */
    .profile-links {
        font-size: 0.82em;
        margin-top: 10px;
        gap: 6px 12px; /* Optimized gap for mobile */
        justify-content: center; /* Ensure centering on mobile too */
        line-height: 1.3;
    }
    .profile-links a {
        padding: 3px 6px; /* Slightly more padding for easier mobile tapping */
        border-radius: 4px;
    }
}

/* Extra small screens (iPhone SE, etc.) */
@media (max-width: 375px) {
    .profile-links {
        font-size: 0.78em;
        gap: 4px 8px; /* Tighter gap for very small screens */
        margin-top: 8px;
    }
    .profile-links a {
        padding: 2px 4px; /* Compact padding for very small screens */
        border-radius: 3px;
    }
}



        /* Thread-specific styles */
        .thread-title {
            font-size: 1.5em;
            font-weight: bold;
            color: var(--text-color);
            margin-bottom: 12px;
            line-height: 1.3;
            border-bottom: 1px solid var(--soft-border-color);
            padding-bottom: 8px;
        }
        .thread-title {
            font-family: 'Literata', Georgia, serif;
            font-weight: 600;
            font-optical-sizing: auto;
        }

        .thread-separator {
            display: flex;
            align-items: center;
            margin: 8px 0;
            opacity: 0.6;
        }

        .thread-separator-dot {
            width: 4px;
            height: 4px;
            background-color: var(--light-text-color);
            border-radius: 50%;
            margin-right: 8px;
        }

        .thread-separator-timestamp {
            font-size: 0.75em;
            color: var(--light-text-color);
            text-decoration: none;
            padding: 2px 4px;
            border-radius: 3px;
            transition: color 0.2s ease, background-color 0.2s ease;
        }

        .thread-separator-timestamp:hover {
            color: var(--text-color);
            background-color: var(--hover-bg-color);
            text-decoration: none;
        }

        .thread-thought {
            margin-bottom: 0;
            padding: 0;
            border: none;
            background: transparent;
        }

        .thread-thought .thought-content p {
            margin-bottom: 6px;
            white-space: pre-wrap;
            color: var(--text-color);
            font-family: 'Literata', Georgia, serif;
            font-weight: 270;
            font-optical-sizing: auto;
            line-height: 1.2;
        }

        .thread-thought .thought-image {
            margin: 12px 0;
        }

        .thread-thought .thought-image .lightbox-trigger {
            display: block;
            max-width: 550px;
            width: 100%;
            margin-left: auto;
            margin-right: auto;
            cursor: pointer;
            overflow: hidden;
            border-radius: 8px;
            border: 1px solid var(--border-color);
            position: relative;
            transition: border-color 0.3s ease;
        }

        .thread-thought img.thread-thought-img {
            display: block;
            width: 100%;
            height: auto;
            transition: opacity 0.2s ease-in-out;
        }

        .thread-thought .lightbox-trigger:hover img.thread-thought-img {
            opacity: 0.9;
        }

        /* Thread actions styling */
        .thread-actions {
            padding-top: 15px;
            margin-top: 20px;
            border-top: 1px solid var(--soft-border-color);
        }
        
        .action-separator {
            height: 1px;
            background: repeating-linear-gradient(
                to right,
                var(--light-text-color) 0px,
                var(--light-text-color) 2px,
                transparent 2px,
                transparent 6px
            );
            margin-bottom: 8px;
            opacity: 0.6;
        }

        .action-buttons {
            display: flex;
            justify-content: flex-end;
            align-items: center;
        }

        .comment-button, .share-button {
            background: transparent;
            border: none;
            font-size: 1.2em;
            cursor: pointer;
            padding: 0;
            border-radius: 4px;
            color: var(--secondary-text-color);
            transition: color 0.2s ease, transform 0.2s ease;
            font-family: inherit;
            outline: none;
            margin-right: 6pt;
            -webkit-tap-highlight-color: transparent;
            text-decoration: none;
            text-shadow: 0 0 0.5px rgba(0,0,0,0.5), 0 0 4px rgba(0,0,0,0.35);
        }

        .comment-button:hover, .share-button:hover {
            color: var(--text-color);
            transform: scale(1.1);
        }

        .comment-button:active, .share-button:active {
            transform: scale(0.95);
            color: var(--text-color);
        }

        /* Lightbox styles */
        .lightbox-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--lightbox-bg);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            padding: 40px;
            box-sizing: border-box;
            transition: background-color 0.3s ease;
        }
        .lightbox-overlay.visible {
            display: flex;
        }
        .lightbox-content {
            position: relative;
            display: flex;
            justify-content: center;
            align-items: center;
            max-width: 100%;
            max-height: 100%;
        }
        .lightbox-content img {
            display: block;
            max-width: 100%;
            max-height: 100%;
            width: auto;
            height: auto;
            object-fit: contain;
            border: none;
            box-shadow: 0 5px 30px rgba(0,0,0,0.5);
        }
        .lightbox-close {
            position: absolute;
            top: -10px;
            right: -10px;
            background: var(--lightbox-close-bg);
            color: var(--lightbox-close-color);
            border: none;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            font-size: 24px;
            font-weight: normal;
            line-height: 28px;
            text-align: center;
            cursor: pointer;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            transition: background-color 0.2s ease, color 0.2s ease;
        }
        .lightbox-close:hover {
            background-color: var(--lightbox-close-hover-bg);
        }

        /* Navigation styling */
        .thread-navigation {
            margin-top: 20px;
            text-align: center;
            padding-bottom: 20px;
        }

        .nav-button {
            padding: 8px 15px;
            text-decoration: none;
            border: 1px solid var(--border-color);
            border-radius: 5px;
            color: var(--link-color);
            background-color: transparent;
            transition: background-color 0.2s ease, color 0.2s ease;
            display: inline-block;
            margin: 0 5px;
        }

        .nav-button:hover {
            background-color: var(--link-color);
            color: var(--container-bg);
            text-decoration: none;
        }

        /* Mobile responsive */
        @media (max-width: 600px) {
            .thread-title {
                font-size: 1.3em;
                margin-bottom: 10px;
            }
            .thread-separator {
                margin: 6px 0;
            }
            .thread-separator-timestamp {
                font-size: 0.7em;
            }
            .thread-thought .thought-image .lightbox-trigger {
                max-width: 100%;
                border-radius: 6px;
            }
            .lightbox-overlay {
                padding: 10px;
            }
            .lightbox-close {
                top: 5px;
                right: 5px;
                width: 28px;
                height: 28px;
                font-size: 20px;
                line-height: 26px;
            }
            .thread-navigation {
                display: flex !important;
                flex-direction: column !important;
                gap: 10px !important;
            }
            .nav-button {
                width: 100% !important;
                margin: 0 !important;
                text-align: center !important;
                box-sizing: border-box !important;
            }
        }

        /* Share feedback toast */
        .share-feedback {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background-color: var(--text-color);
            color: var(--bg-color);
            padding: 12px 20px;
            border-radius: 6px;
            font-size: 0.9em;
            z-index: 1001;
            animation: slideUp 0.3s ease-out;
            max-width: 90%;
            text-align: center;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateX(-50%) translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateX(-50%) translateY(0);
            }
        }

    </style>
</head>
<body>
    <div class="container">
        <div class="profile-box">
    <div class="profile-content">
        <img src="https://illya.sh/staticthoughts/data/profile.png" alt="Profile Picture" class="profile-img">
        <div class="profile-details">
            <div class="profile-name">Illya Gerasymchuk</div>
            <div class="profile-title">Engineering & Finance</div>
        </div>
    </div>
    <div class="profile-links">
        <a href="https://illya.sh" target="_blank">üè† Homepage</a><a href="https://illya.sh/thoughts/">üí≠ Thoughts</a><a href="https://illya.sh/threads/topics/">üìÇ Topics</a><a href="mailto:hello@illya.sh" target="_blank">‚úâÔ∏è Email</a><a href="https://twitter.com/illyaGera" target="_blank">üê¶ Twitter/X</a><a href="https://illya.sh/threads/feed.xml" target="_blank">üì° RSS</a>
    </div>
</div>

        <div class="thread-container">
    <h1 class="thread-title">if you buy a car with Bitcoin, you&#x27;re still subject to capital gains tax</h1>
    <div class="thread-thought">
    <div class="thought-content">
        <p>under the US law cryptocurrencies are property - so you&#x27;re taxed on the USD value of the car at the time of purchase minus the cost of your original crypto purchase (so you&#x27;re only taxed on the gain/profit)<br><br>so if the processing fee of a payment with Ethereum is larger than it would be by selling Ethereum for USD first (e.g. transfer ETH to an exchange --&gt; sell --&gt; transfer to your bank account), then you end up paying more with Ethereum than you would with USD. it make sense, because you&#x27;d be removing an intermediary (i.e. you sell ETH for USD yourself)<br><br>in either case, the seller receives USD for the car, not ETH or BTC. the intermediary most likely doesn&#x27;t keep ETH/BTC on their balance sheet either, they just proxy your order to the market and charge a spread</p>
        <div class="thought-image"><a href="https://illya.sh/staticthoughts/data/images/if-you-buy-a-car-with-bitcoin-youre-still-subject-to-capital.jpg" class="lightbox-trigger"><img loading="lazy" src="https://illya.sh/staticthoughts/data/images/if-you-buy-a-car-with-bitcoin-youre-still-subject-to-capital.jpg" alt="Thread Image" class="thread-thought-img"></a></div>
    </div>
</div>
<div class="thread-separator">
    <div class="thread-separator-dot"></div>
    <a href="https://illya.sh/thoughts/if-you-buy-a-car-with-bitcoin-youre-still-subject-to-capital" class="thread-separator-timestamp">2025-09-28 18:07</a>
</div>
    
        <div class="thread-actions">
            <div class="action-separator"></div>
            <div class="action-buttons">
                <a href="https://illya.sh/thoughts/comment.html?id=if-you-buy-a-car-with-bitcoin-youre-still-subject-to-capital" class="comment-button" aria-label="Comment on this thread">üí¨</a>
                <button class="share-button" data-share-url="https://illya.sh/threads/if-you-buy-a-car-with-bitcoin-youre-still-subject-to-capital" data-share-title="if you buy a car with Bitcoin, you&#x27;re still subject to capital gains tax" data-share-text="" aria-label="Share this thread">üì§</button>
            </div>
        </div>
</div>

        <style>
            .thread-nav-container {
                margin-top: 20px;
                padding-bottom: 20px;
                display: flex;
                flex-direction: column;
                align-items: stretch;
                gap: 10px;
            }
            .thread-nav-container .nav-btn {
                padding: 10px 15px;
                text-decoration: none;
                border: 1px solid;
                border-radius: 5px;
                text-align: center;
                white-space: nowrap;
                box-sizing: border-box;
            }
            /* Large screens: all buttons in one row */
            @media (min-width: 750px) {
                .thread-nav-container {
                    flex-direction: row;
                    flex-wrap: nowrap;
                    justify-content: center;
                    gap: 8px;
                }
                .thread-nav-container .nav-btn {
                    padding: 8px 12px;
                    font-size: 0.85em;
                }
            }
        </style>
        <nav class="thread-nav-container">
            <a id="back-button" href="javascript:history.back()" class="nav-btn nav-button" style="display: none;">‚¨ÖÔ∏è Back</a>
            <a href="https://illya.sh/threads/topics/" class="nav-btn nav-button">üìÇ Thread Topics</a>
            <a href="https://illya.sh/threads/" class="nav-btn nav-button">üßµ Latest Threads</a>
            <a href="https://illya.sh/thoughts/" class="nav-btn nav-button">üè† Latest Thoughts</a>
        </nav>
        <script>
            (function() {
                if (window.history && window.history.length > 1 && document.referrer && document.referrer !== window.location.href) {
                    var backButton = document.getElementById('back-button');
                    if (backButton) { backButton.style.display = 'inline-block'; }
                }
            })();
        </script>
    </div>

    <!-- Lightbox Structure -->
    <div id="lightbox" class="lightbox-overlay">
        <div class="lightbox-content">
            <button class="lightbox-close" aria-label="Close">&times;</button>
            <img src="" alt="Lightbox image">
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const lightbox = document.getElementById('lightbox');
            const lightboxImg = lightbox.querySelector('img');
            const lightboxClose = lightbox.querySelector('.lightbox-close');
            const triggers = document.querySelectorAll('.lightbox-trigger');

            triggers.forEach(trigger => {
                trigger.addEventListener('click', (e) => {
                    e.preventDefault();
                    const imgSrc = trigger.getAttribute('href');
                    lightboxImg.setAttribute('src', imgSrc);
                    lightbox.classList.add('visible');
                    document.body.style.overflow = 'hidden';
                });
            });

            function closeLightbox() {
                lightbox.classList.remove('visible');
                lightboxImg.setAttribute('src', '');
                document.body.style.overflow = '';
            }

            lightboxClose.addEventListener('click', closeLightbox);
            lightbox.addEventListener('click', (e) => {
                if (e.target === lightbox) {
                    closeLightbox();
                }
            });
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape' && lightbox.classList.contains('visible')) {
                    closeLightbox();
                }
            });

            // Share button functionality
            const shareButtons = document.querySelectorAll('.share-button');
            const DOUBLE_THRESHOLD = 500;

            shareButtons.forEach(btn => {
                let clickTimer = null;
                btn.addEventListener('click', (e) => {
                    e.preventDefault();
                    e.stopPropagation();

                    const shareData = {
                        title: btn.dataset.shareTitle,
                        text: btn.dataset.shareText,
                        url: btn.dataset.shareUrl
                    };

                    if (clickTimer) {
                        clearTimeout(clickTimer);
                        clickTimer = null;
                        performCopy(shareData.url);
                        return;
                    }

                    clickTimer = setTimeout(() => {
                        clickTimer = null;
                        showNativeShare(shareData);
                    }, DOUBLE_THRESHOLD);
                });
            });

            async function showNativeShare(shareData) {
                if (navigator.share) {
                    try {
                        await navigator.share(shareData);
                        return;
                    } catch (err) {
                        if (!err || (err.name !== 'AbortError' && err.name !== 'NotAllowedError')) {
                            performCopy(shareData.url);
                        }
                        return;
                    }
                }
                performCopy(shareData.url);
            }

            function performCopy(url) {
                if (navigator.clipboard && navigator.clipboard.writeText) {
                    navigator.clipboard.writeText(url).then(() => {
                        toast('Link copied to clipboard! üìã');
                    }).catch(() => {
                        toast('Copy this link: ' + url);
                    });
                } else {
                    toast('Copy this link: ' + url);
                }
            }

            function toast(msg) {
                const old = document.querySelector('.share-feedback');
                if (old) old.remove();
                const el = document.createElement('div');
                el.className = 'share-feedback';
                el.textContent = msg;
                document.body.appendChild(el);
                setTimeout(() => el.remove(), 3000);
            }
        });
    </script>
</body>
</html>