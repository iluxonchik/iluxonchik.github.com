<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Basic SEO / Title -->
    <title>MicroStrategy (MSTR) strategy &amp; equity analysis ‚Äì Thoughts</title> 
    <link rel="canonical" href="https://illya.sh/thoughts/strategy-mstr-microstrategy">
    <meta name="description" content="Updates on MicroStrategy&#x27;s balance sheet, Bitcoin treasury, leverage, convertible debt and how the stock trades relative to spot BTC.">
    <meta name="robots" content="index, follow">
    
    <!-- Open Graph / Social Media Tags -->
    <meta property="og:title" content='MicroStrategy (MSTR) strategy & equity analysis ‚Äì Thoughts' />
    <meta property="og:type" content='website' />
    <meta property="og:url" content='https://illya.sh/thoughts/strategy-mstr-microstrategy' />
    <meta property="og:image" content='https://illya.sh/staticthoughts/data/illya_gerasymchuk_thoughts.webp' />
    <meta property="og:description" content="Updates on MicroStrategy's balance sheet, Bitcoin treasury, leverage, convertible debt and how the stock trades relative to spot BTC." />
    <meta property="og:site_name" content='Illya Gerasymchuk | Financial Markets, Macro, Bitcoin & Commodities' />
    <meta name="twitter:card" content='summary_large_image' />
    <meta name="twitter:title" content='MicroStrategy (MSTR) strategy & equity analysis ‚Äì Thoughts' />
    <meta name="twitter:description" content="Updates on MicroStrategy's balance sheet, Bitcoin treasury, leverage, convertible debt and how the stock trades relative to spot BTC." />
    <meta name="twitter:image" content='https://illya.sh/staticthoughts/data/illya_gerasymchuk_thoughts.webp' />
    <meta property="og:image:alt" content='MicroStrategy (MSTR) strategy & equity analysis ‚Äì Thoughts' />
    <meta name="twitter:image:alt" content='MicroStrategy (MSTR) strategy & equity analysis ‚Äì Thoughts' />
    <!-- RSS Feed Discovery -->
    <link rel="alternate" type="application/rss+xml" title="Illya Gerasymchuk Thoughts RSS" href="https://illya.sh/thoughts/feed.xml"/>
    <link rel="alternate" type="application/rss+xml" title="Illya Gerasymchuk Threads RSS" href="https://illya.sh/threads/feed.xml"/>

    <!-- Font Preload (CORS/crossorigin required for woff2) -->
    <link rel="preload" href="/staticthoughts/data/fonts/literata/Literata-VF-latin.woff2" as="font" type="font/woff2" crossorigin="anonymous">
    <link rel="preload" href="/staticthoughts/data/fonts/literata/Literata-Italic-VF-latin.woff2" as="font" type="font/woff2" crossorigin="anonymous">

    <script type="application/ld+json">
{"@context": "https://schema.org", "@graph": [{"@type": "Person", "@id": "https://illya.sh/#person", "name": "Illya Gerasymchuk", "url": "https://illya.sh/thoughts", "image": "https://illya.sh/staticthoughts/data/profile.png", "sameAs": ["https://illya.sh", "https://github.com/iluxonchik", "https://twitter.com/illyaGera", "https://x.com/illyaGera"], "alternateName": "Illya", "jobTitle": "Financial & Software Engineer", "description": "I build software and write about how money moves: central banks, liquidity, financial market structure, commodities, Bitcoin, crypto markets, and AI systems.", "knowsAbout": ["Monetary policy", "Central banks", "Global liquidity", "Financial market structure", "Market microstructure", "Financial system infrastructure", "Commodities", "Gold", "Silver", "Bitcoin", "Crypto markets", "DeFi", "Stablecoins", "Foreign exchange", "AI systems", "Agentic AI systems", "Software engineering", "Financial law"]}, {"@type": "CollectionPage", "name": "MicroStrategy (MSTR) strategy & equity analysis", "url": "https://illya.sh/thoughts/strategy-mstr-microstrategy", "description": "Updates on MicroStrategy's balance sheet, Bitcoin treasury, leverage, convertible debt and how the stock trades relative to spot BTC.", "author": {"@id": "https://illya.sh/#person"}, "publisher": {"@id": "https://illya.sh/#person"}}, {"@type": "BlogPosting", "headline": "The model factory has been refactored to use a DSL for configuring the pipeline -- so now you can visualize a...", "articleBody": "The model factory has been refactored to use a DSL for configuring the pipeline -- so now you can visualize and configure the whole flow from a single place\n\nThis also makes it easier for agents to autonomously discover and verify profitable trading strategies, but I'll cover that in more detail in another post üòÅ", "url": "https://illya.sh/thoughts/the-model-factory-has-been-refactored-to-use-a-dsl-for", "mainEntityOfPage": "https://illya.sh/thoughts/the-model-factory-has-been-refactored-to-use-a-dsl-for", "datePublished": "2026-02-24T12:55:39+00:00", "dateModified": "2026-02-24T12:55:39+00:00", "keywords": "Illya Gerasymchuk, Financial & Software Engineer, financial markets, monetary policy, central banks, global liquidity, financial market structure, commodities, gold, silver, Bitcoin, crypto markets, AI systems, software engineering, financial law, machine learning, agentic AI systems, finance, cryptocurrency, Zero-Knowledge Proofs, blockchain", "author": {"@id": "https://illya.sh/#person"}, "publisher": {"@id": "https://illya.sh/#person"}, "image": "https://illya.sh/staticthoughts/data/images/the-model-factory-has-been-refactored-to-use-a-dsl-for.jpg"}, {"@type": "BlogPosting", "headline": "A Primer On Strategy/MSTR Business, Financials, Liquidity and Solvency", "articleBody": "A Primer On Strategy/MSTR Business, Financials, Liquidity and Solvency\n\nThere's a lot of misinformation how Strategy/MicroStrategy operates, its business model and what MSTR can and can't do.\n\nThis served as a motivation for me to write 4 short, primer-style articles on MSTR:\n\n1Ô∏è‚É£ MSTR‚Äôs business model, describing how the company operates as a \"Bitcoin treasury\" and what does it mean for its solvency. You can read it here: https://illya.sh/threads/microstrategy-is-dependent-on-refinancing-capacity-not\n\n2Ô∏è‚É£ Why MicroStrategy can‚Äôt replay its debt using equity/stock. You can read it here: https://illya.sh/threads/microstrategy-cant-repay-its-debt-in-equity-stock\n\n3Ô∏è‚É£ How Strategy pays for its interest, which currently accounts to ‚âà$40M/year. You can read it here:  https://illya.sh/threads/how-microstrategy-pays-interest-on-its-debt\n ¬†\n4Ô∏è‚É£ How Strategy's marketing is misleading regarding MSTR‚Äôs risk, liquidity and solvency. You can read it here: https://illya.sh/threads/strategy-invents-financial-metrics-and-everybody-applauds\n\nI suggest reading them in the same order as above, but they're self-isolated. It's a short read, and together they will give you a good understanding on how Strategy operates (its business model), what are its main risks, what MSTR can and cannot do regarding debt repayments, and why you probably shouldn‚Äôt trust their marketing campaigns, including the statements made by Michael Saylor on X and various podcasts/videos where he appears.", "url": "https://illya.sh/thoughts/a-primer-on-strategy-mstr-business-financials-liquidity-and", "mainEntityOfPage": "https://illya.sh/thoughts/a-primer-on-strategy-mstr-business-financials-liquidity-and", "datePublished": "2025-11-24T15:34:47+00:00", "dateModified": "2025-11-24T15:34:47+00:00", "keywords": "Illya Gerasymchuk, Financial & Software Engineer, financial markets, monetary policy, central banks, global liquidity, financial market structure, commodities, gold, silver, Bitcoin, crypto markets, AI systems, software engineering, financial law, machine learning, agentic AI systems, finance, cryptocurrency, Zero-Knowledge Proofs, blockchain", "author": {"@id": "https://illya.sh/#person"}, "publisher": {"@id": "https://illya.sh/#person"}, "image": "https://illya.sh/staticthoughts/data/images/a-primer-on-strategy-mstr-business-financials-liquidity-and.jpg"}, {"@type": "BlogPosting", "headline": "Strategy Invents Financial Metrics And Everybody Applauds üëè", "articleBody": "Strategy Invents Financial Metrics And Everybody Applauds üëè\n\nMSTR's own website states that their reports do not reflect the financial reality:\n\n\"None of BTC Rating, BTC Credit, or BTC Risk are measures of financial results or liquidity, or key performance indicators.\"\n\nStrategy's software business also operates at a ‚âà$60M loss, but on their website and socials they decide to ignore a part of expenses and market it as profit. So they create their own non-standard accounting and credit metrics and advertise those.\n\nStrategy has a consistent pattern of misrepresenting their financials to look more favorable in their public marketing campaigns. A lot of it is in the form of Michael Saylor's videos, podcast appearances and posts on X. A lot seem to think that just because someone says something in a video or a social media post it must be true. \n\nWords can be deceiving, numbers not so much.", "url": "https://illya.sh/thoughts/strategy-invents-financial-metrics-and-everybody-applauds", "mainEntityOfPage": "https://illya.sh/thoughts/strategy-invents-financial-metrics-and-everybody-applauds", "datePublished": "2025-11-21T14:07:08+00:00", "dateModified": "2025-11-21T14:07:08+00:00", "keywords": "Illya Gerasymchuk, Financial & Software Engineer, financial markets, monetary policy, central banks, global liquidity, financial market structure, commodities, gold, silver, Bitcoin, crypto markets, AI systems, software engineering, financial law, machine learning, agentic AI systems, finance, cryptocurrency, Zero-Knowledge Proofs, blockchain", "author": {"@id": "https://illya.sh/#person"}, "publisher": {"@id": "https://illya.sh/#person"}, "image": "https://illya.sh/staticthoughts/data/images/strategy-invents-financial-metrics-and-everybody-applauds.jpg"}, {"@type": "BlogPosting", "headline": "How MicroStrategy Pays Interest On Its Debt?", "articleBody": "How MicroStrategy Pays Interest On Its Debt?\n\nThe short answer is that MSTR finances its debt service via a mixture of:\n\n‚ûñ Software business cashflow\n‚ûñ Existing reserves & short-term investments\n‚ûñ Capital market instruments, such as issuing new equity or debt\n‚ûñ Asset liquidation (Bitcoin sales)\n\nMSTR's annual coupon payments sum up to ‚âà$34.6M/year. Currently, virtually all of MSTR's financial debt is in convertible bonds/senior notes. Those bonds come with small coupons, so relatively small interest payments.\n\nMore specifically, here is how MicroStrategy's/Strategy's outstanding outstanding convertible bond maturity, principal, coupon rate and total yearly interest  look like:\n\n2028     | $1.01B   @ 0.625%   | $6.3M\n2029     | $3.0B    @ 0%            | $0M\n2030A  | $0.8B     @ 0.625%  | $5M\n2030B  | $2.0B     @ 0%           | $0M\n2031     | $0.604B @ 0.875%  | $5.3M\n2032    | $0.8B       @ 2.25%     | $18M\n\n(Format: <year> | <principal> @ <coupon> | <anual interest>)\n\nIf you sum up the interest payments you‚Äôll get ‚âà$34.6M/year in total.\n\nThe yearly revenue of MSTR's software services business is almost ‚âà$500M/year. However, their software portion of the business actually operates at ‚âà60M/year loss, when using U.S. Generally Accepted Accounting Principles (GAAP).\n\nStrategy advertises their software portion of the business as being in profit, but they \"manipulate\" those numbers a little. This \"manipulation\" involves MSTR not counting stock-based compensation as expenses.\n\nSo when you hear Strategy advertising profit from their software business - they're not using a legally recognized and standardized measure of profit (in the U.S. it's GAAP). So they take the GAAP software profit and then add some things back at their discretion (i.e. they don't count some expenses), thus turning a negative profit (loss) into a positive one.\n\nThis means that while their software business revenue can help them with having liquidity for interest payments - it doesn't cover those costs (since they operate at loss, it actually increases the total cost!).\n\nThus, Strategy finances their interest rate payments with a mixture of:\n\n‚ûñ Existing reserves & short-term investments\n‚ûñ Capital market instruments, such as issuing new equity or debt (main source)\n‚ûñ Asset liquidation\n\nThe software revenue provides significant cashflow (compared to interest rate costs), so it can help with having cash readily available to make an interest payment (liquidity), but it doesn't effectively cover them, thus requiring financing from other sources.", "url": "https://illya.sh/thoughts/how-microstrategy-pays-interest-on-its-debt", "mainEntityOfPage": "https://illya.sh/thoughts/how-microstrategy-pays-interest-on-its-debt", "datePublished": "2025-11-20T08:56:39+00:00", "dateModified": "2025-11-20T08:56:39+00:00", "keywords": "Illya Gerasymchuk, Financial & Software Engineer, financial markets, monetary policy, central banks, global liquidity, financial market structure, commodities, gold, silver, Bitcoin, crypto markets, AI systems, software engineering, financial law, machine learning, agentic AI systems, finance, cryptocurrency, Zero-Knowledge Proofs, blockchain", "author": {"@id": "https://illya.sh/#person"}, "publisher": {"@id": "https://illya.sh/#person"}, "image": "https://illya.sh/staticthoughts/data/images/how-microstrategy-pays-interest-on-its-debt.jpg"}, {"@type": "BlogPosting", "headline": "Strategy (MSTR) pays interest on its debt via a mixture of capital markets, software business cashflow, exist...", "articleBody": "Strategy (MSTR) pays interest on its debt via a mixture of capital markets, software business cashflow, existing reserves & investments and Bitcoin sales.\n\nMSTR's annual coupon payments are not that high - ‚âà$40M/year. The convertible bonds that they issue come with small coupons (e.g. 0%, 0.625%, %0.875, 2.25%)\n\nGiven MSTR's software business revenue of ‚âà$500M/year, but it actually operates at a ‚âà$60M loss after expenses are accounted for.\n\nSo effectively, strategy pays interest expenses from the same corporate funds bucket that they rase to purchase Bitcoin in capital markets.", "url": "https://illya.sh/thoughts/strategy-mstr-pays-interest-on-its-debt-via-a-mixture-of", "mainEntityOfPage": "https://illya.sh/thoughts/strategy-mstr-pays-interest-on-its-debt-via-a-mixture-of", "datePublished": "2025-11-18T14:54:01+00:00", "dateModified": "2025-11-18T14:54:01+00:00", "keywords": "Illya Gerasymchuk, Financial & Software Engineer, financial markets, monetary policy, central banks, global liquidity, financial market structure, commodities, gold, silver, Bitcoin, crypto markets, AI systems, software engineering, financial law, machine learning, agentic AI systems, finance, cryptocurrency, Zero-Knowledge Proofs, blockchain", "author": {"@id": "https://illya.sh/#person"}, "publisher": {"@id": "https://illya.sh/#person"}, "image": "https://illya.sh/staticthoughts/data/illya_gerasymchuk_thoughts.webp"}, {"@type": "BlogPosting", "headline": "MicroStrategy Can't Repay Its Debt In Equity/Stock", "articleBody": "MicroStrategy Can't Repay Its Debt In Equity/Stock\n\nMost of MicroStrategy's debt is in the form of convertible bonds, meaning that by default the principal and the coupons get repaid the cash. \n\nThe \"convertible\" part means the bondholder can choose to convert the bond into shares/equity instead, and then MSTR chooses how settle the conversion of the bond's value in cash, equity or mix.\n\nSo MSTR cannot force the debt settlement/repayment in stock/equity - that's simply an option that the bondholders/investors have. \n\nThe repayment can always be in cash assuming that MSTR is solvent, as most of the debt is unsecured, meaning that there is no specific collateral pledged against that debt. In case of insolvency, unsecured debt holders are treated as general creditors of the company, and are repaid out of the remaining assets only after secured debt holders are repaid, but before equity holders.", "url": "https://illya.sh/thoughts/microstrategy-cant-repay-its-debt-in-equity-stock", "mainEntityOfPage": "https://illya.sh/thoughts/microstrategy-cant-repay-its-debt-in-equity-stock", "datePublished": "2025-11-16T23:01:12+00:00", "dateModified": "2025-11-16T23:01:12+00:00", "keywords": "Illya Gerasymchuk, Financial & Software Engineer, financial markets, monetary policy, central banks, global liquidity, financial market structure, commodities, gold, silver, Bitcoin, crypto markets, AI systems, software engineering, financial law, machine learning, agentic AI systems, finance, cryptocurrency, Zero-Knowledge Proofs, blockchain", "author": {"@id": "https://illya.sh/#person"}, "publisher": {"@id": "https://illya.sh/#person"}, "image": "https://illya.sh/staticthoughts/data/images/microstrategy-cant-repay-its-debt-in-equity-stock.jpg"}, {"@type": "BlogPosting", "headline": "MicroStrategy Is Dependent On Refinancing Capacity, Not Bitcoin Price", "articleBody": "MicroStrategy Is Dependent On Refinancing Capacity, Not Bitcoin Price\n\nMSTR won't have to sell Bitcoin if BTC price goes down, they'll have to sell Bitcoin if they're unable to acquire funding along the maturity of their debt wall. \n\nMicroStrategy is essentially a leveraged trade on Bitcoin, based on the following cycle:\n\n1Ô∏è‚É£ Acquire funding via debt or equity\n2Ô∏è‚É£ Buy Bitcoin\n3Ô∏è‚É£ Repeat\n\nThis cycle works for as long as MSTR is able to obtain funding. Once funding becomes unavailable (i.e. market isn't willing to lend at favorable interest rates), funding must come from asset liquidation (i.e. the sale of Bitcoin).\n\nThe availability of funding is mostly dependent on Bitcoin's price. As long as Bitcoin price and trend is favorable around the dates when the debt wall matures - MSTR should be able to continue their leveraged trade. MSTR share price vs Bitcoin NAV is also important. If MSTR trades a premium over Bitcoin's NAV it allows Microstrategy to short their own equity and long Bitcoin.\n\nHowever, an unfavorable Bitcoin price action environment (e.g. during a bear market) that coincides with debt repayment obligations may trigger the unwinding of this leveraged position, forcing MSTR to sell Bitcoin, thus putting further downwards price pressure on Bitcoin, which lowers Microstrategy's equity even more, which makes lender even less likely to lend. The end result is an even more degraded funding capacity, which at the limit leads to bankruptcy.\n\nDebt starts maturing from 2028 (‚âà$1B), but the most significant portion of ‚âà70%/$5.8B matures in 2029-2030. This is where the price of Bitcoin is of great importance for Microstrategy's solvency.\n\nSo don't expect Microstrategy to have pressure to sell significant amounts of Bitcoin before at least 2027, even if the Bitcoin price stays low.", "url": "https://illya.sh/thoughts/microstrategy-is-dependent-on-refinancing-capacity-not", "mainEntityOfPage": "https://illya.sh/thoughts/microstrategy-is-dependent-on-refinancing-capacity-not", "datePublished": "2025-11-16T16:41:58+00:00", "dateModified": "2025-11-16T16:41:58+00:00", "keywords": "Illya Gerasymchuk, Financial & Software Engineer, financial markets, monetary policy, central banks, global liquidity, financial market structure, commodities, gold, silver, Bitcoin, crypto markets, AI systems, software engineering, financial law, machine learning, agentic AI systems, finance, cryptocurrency, Zero-Knowledge Proofs, blockchain", "author": {"@id": "https://illya.sh/#person"}, "publisher": {"@id": "https://illya.sh/#person"}, "image": "https://illya.sh/staticthoughts/data/images/microstrategy-is-dependent-on-refinancing-capacity-not.jpg"}, {"@type": "BlogPosting", "headline": "Michael Saylor doesn't need to expose MSTR's wallets for a proof of reserves", "articleBody": "Michael Saylor doesn't need to expose MSTR's wallets for a proof of reserves\n\nAll you need is Zero Knowledge Proof attesting that MicroStrategy has access to private key(s) holding a total of X BTC  \n\nWith ZKPs - no Bitcoin addresses are exposed ‚ú®", "url": "https://illya.sh/thoughts/michael-saylor-doesnt-need-to-expose-mstrs-wallets-for-a", "mainEntityOfPage": "https://illya.sh/thoughts/michael-saylor-doesnt-need-to-expose-mstrs-wallets-for-a", "datePublished": "2025-05-27T13:55:06+00:00", "dateModified": "2025-05-27T13:55:06+00:00", "keywords": "Illya Gerasymchuk, Financial & Software Engineer, financial markets, monetary policy, central banks, global liquidity, financial market structure, commodities, gold, silver, Bitcoin, crypto markets, AI systems, software engineering, financial law, machine learning, agentic AI systems, finance, cryptocurrency, Zero-Knowledge Proofs, blockchain", "author": {"@id": "https://illya.sh/#person"}, "publisher": {"@id": "https://illya.sh/#person"}, "image": "https://illya.sh/staticthoughts/data/illya_gerasymchuk_thoughts.webp"}]}
</script>
    
    <style>
        /* Shared base layout + profile header styles.
   Injected into templates via BASE_LAYOUT_AND_PROFILE_CSS placeholder. */

:root {
    /* Light Theme Variables */
    --bg-color: #f4f4f4;
    --container-bg: #ffffff;
    --box-bg: #fff;
    --text-color: #333;
    --secondary-text-color: #555;
    --light-text-color: #666;
    --link-color: #007bff;
    --link-hover-color: #0056b3;
    --border-color: #ddd;
    --soft-border-color: #eee;
    --dashed-border-color: #aaa;
    --box-shadow-color: rgba(0,0,0,0.08);
    --lightbox-bg: rgba(0, 0, 0, 0.9);
    --lightbox-close-bg: rgba(255, 255, 255, 0.8);
    --lightbox-close-hover-bg: rgba(255, 255, 255, 1);
    --lightbox-close-color: #000;
    --disabled-text-color: #aaa;
    --disabled-bg-color: #f9f9f9;
    --hover-bg-color: #eee;
}

/* Dark Theme Variables (applied via media query or body class) */
.dark-mode {
    --bg-color: #1a1a1a; /* Dark grey background */
    --container-bg: #2b2b2b; /* Slightly lighter container */
    --box-bg: #2b2b2b; /* Same as container for profile/thought boxes */
    --text-color: #e0e0e0; /* Light grey text */
    --secondary-text-color: #b0b0b0; /* Medium grey */
    --light-text-color: #999; /* Lighter grey for dates etc. */
    --link-color: #58a6ff; /* Lighter blue for links */
    --link-hover-color: #80bfff; /* Even lighter blue on hover */
    --border-color: #444; /* Darker border */
    --soft-border-color: #333; /* Even darker soft border */
    --dashed-border-color: #666; /* Darker dashed border */
    --box-shadow-color: rgba(255,255,255,0.08); /* Light shadow */
    --lightbox-bg: rgba(0, 0, 0, 0.95); /* Slightly more opaque */
    --lightbox-close-bg: rgba(50, 50, 50, 0.8);
    --lightbox-close-hover-bg: rgba(70, 70, 70, 1);
    --lightbox-close-color: #eee;
    --disabled-text-color: #777;
    --disabled-bg-color: #3a3a3a;
    --hover-bg-color: #383838;
}

/* Apply dark mode based on system preference */
@media (prefers-color-scheme: dark) {
    :root {
        /* Default to dark variables if system preference is dark */
        /* This will be overridden if .light-mode is explicitly set */
        --bg-color: #1a1a1a;
        --container-bg: #2b2b2b;
        --box-bg: #2b2b2b;
        --text-color: #e0e0e0;
        --secondary-text-color: #b0b0b0;
        --light-text-color: #999;
        --link-color: #58a6ff;
        --link-hover-color: #80bfff;
        --border-color: #444;
        --soft-border-color: #333;
        --dashed-border-color: #666;
        --box-shadow-color: rgba(255,255,255,0.08);
        --lightbox-bg: rgba(0, 0, 0, 0.95);
        --lightbox-close-bg: rgba(50, 50, 50, 0.8);
        --lightbox-close-hover-bg: rgba(70, 70, 70, 1);
        --lightbox-close-color: #eee;
        --disabled-text-color: #777;
        --disabled-bg-color: #3a3a3a;
        --hover-bg-color: #383838;
    }

    /* Ensure explicit light mode overrides system pref */
    .light-mode {
        --bg-color: #f4f4f4;
        --container-bg: #ffffff;
        --box-bg: #fff;
        --text-color: #333;
        --secondary-text-color: #555;
        --light-text-color: #666;
        --link-color: #007bff;
        --link-hover-color: #0056b3;
        --border-color: #ddd;
        --soft-border-color: #eee;
        --dashed-border-color: #aaa;
        --box-shadow-color: rgba(0,0,0,0.08);
        --lightbox-bg: rgba(0, 0, 0, 0.9);
        --lightbox-close-bg: rgba(255, 255, 255, 0.8);
        --lightbox-close-hover-bg: rgba(255, 255, 255, 1);
        --lightbox-close-color: #000;
        --disabled-text-color: #aaa;
        --disabled-bg-color: #f9f9f9;
        --hover-bg-color: #eee;
    }
}

/* --- Webfont: Literata (variable, WOFF2) for reading surfaces --- */
@font-face {
    font-family: 'Literata';
    src: url('/staticthoughts/data/fonts/literata/Literata-VF-latin.woff2') format('woff2-variations');
    font-style: normal;
    font-weight: 200 900;
    font-display: swap;
}
@font-face {
    font-family: 'Literata';
    src: url('/staticthoughts/data/fonts/literata/Literata-Italic-VF-latin.woff2') format('woff2-variations');
    font-style: italic;
    font-weight: 200 900;
    font-display: swap;
}

body {
    font-family: "Courier New", Courier, monospace;
    background-color: var(--bg-color); /* USE VAR */
    color: var(--text-color); /* USE VAR - Set default text color */
    margin: 0;
    padding: 20px;
    display: flex;
    justify-content: center;
    transition: background-color 0.3s ease, color 0.3s ease; /* Smooth transition */
}

a {
    color: var(--link-color);
    text-decoration: none; /* Consistent link styling */
    transition: color 0.2s ease;
}
a:hover {
    color: var(--link-hover-color);
    text-decoration: underline; /* Underline on hover for clarity */
}
a:visited {
    color: var(--link-color); /* Ensure visited links use theme color */
}

.container {
    background-color: var(--container-bg); /* USE VAR */
    padding: 25px;
    border: 1px solid var(--border-color); /* USE VAR */
    max-width: 750px;
    width: 100%;
    box-sizing: border-box;
    box-shadow: 0 1px 4px var(--box-shadow-color); /* USE VAR */
    transition: background-color 0.3s ease, border-color 0.3s ease; /* Smooth transition */
}

/* Profile Box Styling */
.profile-box {
    border: 2px dashed var(--dashed-border-color); /* USE VAR */
    padding: 15px;
    margin-bottom: 30px;
    background-color: var(--box-bg); /* USE VAR */
    display: flex;
    flex-direction: column;
    align-items: center;
    transition: background-color 0.3s ease, border-color 0.3s ease; /* Smooth transition */
}
.profile-content {
    display: flex;
    align-items: center;
    justify-content: center;
    margin-bottom: 0; /* Remove vertical spacing */
    width: 100%;
}
.profile-img {
    width: 60px;
    height: 60px;
    border-radius: 50%;
    object-fit: cover;
    margin-right: 15px;
    border: 1px solid var(--soft-border-color); /* USE VAR */
    box-shadow: 0 0 0 4px #00aef5;
    flex-shrink: 0;
    cursor: pointer; /* Theme toggle on thoughts pages */
    transition: border-color 0.3s ease, box-shadow 0.3s ease; /* Smooth transition */
}
.profile-details {
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
}
.profile-name {
    font-weight: bold;
    font-size: 1.2em;
    margin-bottom: 2px;
    color: var(--text-color); /* Ensure uses variable */
}
.profile-title {
    color: var(--secondary-text-color); /* USE VAR */
    font-size: 0.95em;
}
.profile-links {
    font-size: 0.9em;
    color: var(--secondary-text-color); /* USE VAR */
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    align-items: center;
    gap: 8px 16px;
    padding: 0;
    margin-top: 12px;
    line-height: 1.4;
}
.profile-links a {
    text-decoration: none;
    color: var(--link-color); /* USE VAR */
    transition: color 0.2s ease;
    white-space: nowrap;
    padding: 2px 4px;
    border-radius: 3px;
    display: inline-block;
}
.profile-links a:hover {
    color: var(--link-hover-color); /* USE VAR */
    background-color: var(--hover-bg-color);
}

/* Screen-reader only content (kept semantic/SEO-visible, visually hidden). */
.visually-hidden {
    position: absolute !important;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border: 0;
}

/* Shared responsive */
@media (max-width: 600px) {
    body {
        padding: 10px;
    }
    .container {
        padding: 15px;
        max-width: 100%;
    }
    /* Adjusted Profile Box for Mobile */
    .profile-box {
        padding: 12px; /* Further reduced padding */
        margin-bottom: 25px; /* Further reduced margin */
    }
    /* Adjusted Profile Content for Mobile */
    .profile-content {
        align-items: center;
        justify-content: center;
        margin-bottom: 0; /* No spacing between profile content and links */
    }
    .profile-img {
        width: 50px;
        height: 50px;
        margin-right: 12px;
    }
    .profile-name {
        font-size: 1.1em;
    }
    .profile-title {
        font-size: 0.9em;
    }
    /* Adjusted Profile Links for Mobile */
    .profile-links {
        font-size: 0.82em;
        margin-top: 10px;
        gap: 6px 12px; /* Optimized gap for mobile */
        justify-content: center; /* Ensure centering on mobile too */
        line-height: 1.3;
    }
    .profile-links a {
        padding: 3px 6px; /* Slightly more padding for easier mobile tapping */
        border-radius: 4px;
    }
}

/* Extra small screens (iPhone SE, etc.) */
@media (max-width: 375px) {
    .profile-links {
        font-size: 0.78em;
        gap: 4px 8px; /* Tighter gap for very small screens */
        margin-top: 8px;
    }
    .profile-links a {
        padding: 2px 4px; /* Compact padding for very small screens */
        border-radius: 3px;
    }
}


        /* Thoughts Header - Section Title Style */
        .thoughts-header {
            border: none;
            background-color: transparent;
            padding: 0; 
            display: block; 
            font-size: 1.4em; 
            font-weight: bold;
            color: var(--text-color); /* USE VAR */
            margin-top: 0; 
            margin-bottom: 25px; 
            padding-bottom: 8px; 
            border-bottom: 2px solid var(--soft-border-color); /* USE VAR */
            text-align: center; 
            transition: color 0.3s ease, border-color 0.3s ease; /* Smooth transition */
        }
        /* Apply Literata to the primary reading title */
        .thoughts-header {
            font-family: Georgia, 'Literata', serif;
            font-weight: 600;
            font-optical-sizing: auto;
        }

        /* Thought Box Styling */
        .thought-box {
            border: 2px dashed var(--dashed-border-color); /* USE VAR */
            padding: 10pt;
            padding-top: 1pt;
            padding-bottom: 1pt;
            margin-bottom: 14pt; 
            background-color: var(--box-bg); /* USE VAR */
            transition: background-color 0.3s ease, border-color 0.3s ease; /* Smooth transition */
        }

        /* Hover effect for clickable thought boxes (applied via JavaScript based on page type) */
        .thought-box.clickable:hover {
            background-color: var(--hover-bg-color);
            border-color: var(--text-color);
        }
        .thought-header {
            display: flex; 
            align-items: center; 
            flex-wrap: wrap; 
            gap: 0.5em;
            padding-bottom: 0px;
            font-size: 0.95em;
            color: var(--secondary-text-color); /* USE VAR */
        }
        .thought-user-img { 
             width: 25px;
             height: 25px;
             border-radius: 50%;
             object-fit: cover;
             border: 1px solid var(--soft-border-color); /* USE VAR */
             vertical-align: middle; 
             transition: border-color 0.3s ease; /* Smooth transition */
        }
        .thought-header .user-name {
            font-weight: bold;
            color: var(--text-color); /* USE VAR */
            margin: 0; 
        }
         .thought-header .separator {
             margin: 0 0.2em; 
             color: var(--light-text-color); /* Separator should probably use this */
         }
         .thought-header .date-time {
             color: var(--light-text-color); /* USE VAR */
             flex-shrink: 0; 
         }

        .thought-content p {
            margin-top: 0;
            margin-bottom: 10px;
            white-space: pre-wrap;
            word-wrap: break-word;
            color: var(--text-color); /* Ensure paragraph text uses variable */
        }
        /* Apply Literata to main reading paragraphs */
        .thought-content p,
        .quoted-thought-content p {
            font-family: 'Literata', Georgia, serif;
            font-weight: 270;
            font-optical-sizing: auto;
            line-height: 1.2;
        }
        .thought-image {
            margin-top: 15px; 
        }
        .thought-image .lightbox-trigger {
            display: block;
            max-width: 550px;  
            width: 100%; 
            margin-left: auto;
            margin-right: auto;
            cursor: pointer;
            overflow: hidden;
            border-radius: 8px;
            border: 1px solid var(--border-color); /* USE VAR */
            position: relative;
            transition: border-color 0.3s ease; /* Smooth transition */
        }
        .thought-image img.thought-img {
            display: block; 
            width: 100%; 
            height: auto; 
            transition: opacity 0.2s ease-in-out; 
        }
         .thought-image .lightbox-trigger:hover img.thought-img {
              opacity: 0.9; 
         }

        /* Lightbox Overlay */
        .lightbox-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--lightbox-bg); /* USE VAR */
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            padding: 40px;
            box-sizing: border-box;
            transition: background-color 0.3s ease; /* Smooth transition */
        }
        .lightbox-overlay.visible {
            display: flex; 
        }
        .lightbox-content {
            position: relative;
            display: flex;
            justify-content: center;
            align-items: center;
            max-width: 100%; 
            max-height: 100%;
        }
        .lightbox-content img {
            display: block;
            max-width: 100%; 
            max-height: 100%; 
            width: auto;
            height: auto;
            object-fit: contain;
            border: none;
            box-shadow: 0 5px 30px rgba(0,0,0,0.5); /* Keep shadow potentially dark */
        }
        .lightbox-close {
            position: absolute;
            top: -10px;
            right: -10px;
            background: var(--lightbox-close-bg); /* USE VAR */
            color: var(--lightbox-close-color); /* USE VAR */
            border: none;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            font-size: 24px;
            font-weight: normal;
            line-height: 28px;
            text-align: center;
            cursor: pointer;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            transition: background-color 0.2s ease, color 0.2s ease; /* Smooth transition */
        }
        .lightbox-close:hover {
            background-color: var(--lightbox-close-hover-bg); /* USE VAR */
        }

        /* Responsive Design */
        @media (max-width: 600px) {
            .thoughts-header {
                font-size: 1.2em;
                margin-bottom: 20px;
            }
            .thought-box {
                padding: 10pt;
                padding-bottom: 1pt;
                padding-top: 1pt;
                margin-bottom: 14pt;
            }
             .thought-header {
                font-size: 0.85em; /* Even smaller font for mobile header */
                gap: 0.3em; /* Further reduce gap */
                padding-bottom: 0px; /* Reduce padding */
             }
             .thought-user-img {
                 width: 20px; /* Even smaller image on mobile */
                 height: 20px;
             }
             /* Optionally hide separator on very small screens if needed */
             /* .thought-header .separator { display: none; } */
        }

        /* Extra small screens (iPhone SE, etc.) */
        @media (max-width: 380px) {
             .thought-header {
                font-size: 0.8em; /* Even smaller font for very small screens */
                gap: 0.25em; /* Minimal gap */
             }
             .thought-header .date-time {
                flex-shrink: 1; /* Allow date to shrink if needed */
                min-width: 0; /* Allow text truncation */
             }

             .thought-image .lightbox-trigger {
                  /* Remove max-width on mobile to allow full width */
                  max-width: 100%; 
                  border-radius: 6px; 
             }

             .lightbox-overlay { padding: 10px; }
             .lightbox-content {
                  /* Adjust max size slightly for smaller padding */
                  /* REMOVE THESE - they were overriding the general rules */
                  /* max-width: calc(100vw - 20px); */
                  /* max-height: calc(100vh - 20px); */
              }
             .lightbox-close {
                 top: 5px; right: 5px; width: 28px; height: 28px;
                 font-size: 20px; line-height: 26px;
             }

            .pagination {
                margin-top: 20px;
                padding-top: 15px;
                font-size: 0.85em; /* Smaller text on mobile */
            }
             .pagination a, .pagination span {
                 padding: 6px 10px; /* Smaller padding */
                 margin: 0 2px; /* Less margin */
             }
             .pagination span.page-info {
                 display: none; /* Optionally hide page number on very small screens */
             }

            /* Individual thought navigation responsive */
            .individual-thought-navigation {
                display: flex !important;
                flex-direction: column !important;
                gap: 10px !important;
                margin-top: 20px !important;
            }
            .individual-thought-navigation .nav-button {
                width: 100% !important;
                margin-right: 0 !important;
                margin-left: 0 !important;
                text-align: center !important;
                box-sizing: border-box !important;
            }

            /* Quoted thought images on mobile */
            .quoted-thought-image img {
                max-width: 70%; /* Even smaller on mobile for better proportion */
                max-height: 200px; /* Smaller height limit on mobile */
            }
        }

        /* Pagination Styling */
        .pagination {
            margin-top: 30px; /* Space above pagination */
            padding-top: 20px; /* Space below last thought */
            border-top: 1px solid var(--soft-border-color); /* USE VAR */
            text-align: center;
            display: flex; /* Use flexbox for alignment */
            justify-content: space-between; /* Space out Prev, Info, Next */
            align-items: center;
            transition: border-color 0.3s ease; /* Smooth transition */
        }
        .pagination a, .pagination span {
            display: inline-block;
            padding: 8px 16px;
            margin: 0 4px;
            border: 1px solid var(--border-color); /* USE VAR */
            border-radius: 4px;
            color: var(--link-color); /* USE VAR */
            text-decoration: none;
            transition: background-color 0.2s ease, color 0.2s ease, border-color 0.2s ease;
            font-size: 0.9em;
        }
        .pagination a:hover {
            background-color: var(--hover-bg-color); /* USE VAR */
            color: var(--link-hover-color); /* USE VAR */
        }
        .pagination span.disabled {
            color: var(--disabled-text-color); /* USE VAR */
            background-color: var(--disabled-bg-color); /* USE VAR */
            cursor: default;
            border-color: var(--border-color); /* USE VAR - Use regular border color for consistency */
        }
        .pagination span.page-info {
             border: none; 
             color: var(--secondary-text-color); /* USE VAR */
             background-color: transparent;
        }

        /* Quoted Thought Styling */
        .quoted-thought-container {
            margin-top: 15px;
            border-left: 3px solid var(--border-color);
            padding-left: 15px;
            transition: border-color 0.3s ease;
        }

        .quoted-thought-box {
            border: 1px solid var(--soft-border-color);
            border-radius: 8px;
            padding: 12px;
            background-color: var(--box-bg);
            font-size: 0.9em; /* Slightly smaller text */
            transition: background-color 0.3s ease, border-color 0.3s ease;
        }

        .quoted-thought-box:hover {
            background-color: var(--hover-bg-color);
            cursor: pointer;
        }

        .quoted-thought-header {
            display: flex;
            align-items: center;
            margin-bottom: 8px;
            font-size: 0.85em;
        }

        .quoted-thought-user-img {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            object-fit: cover;
            margin-right: 8px;
            border: 1px solid var(--soft-border-color);
            transition: border-color 0.3s ease;
        }

        .quoted-user-name {
            font-weight: bold;
            color: var(--text-color);
            margin-right: 5px;
        }

        .quoted-thought-date-time {
            color: var(--light-text-color);
            margin: 0;
            font-size: 0.9em;
        }

        .quoted-thought-permalink {
            color: var(--light-text-color);
            text-decoration: none;
            transition: color 0.2s ease;
        }

        .quoted-thought-permalink:hover {
            color: var(--link-hover-color);
            text-decoration: underline;
        }

        /* Mobile responsive adjustments for quoted thoughts */
        @media (max-width: 600px) {
            .quoted-thought-container {
                padding-left: 10px;
                margin-top: 12px;
            }
            
            .quoted-thought-box {
                padding: 10px;
                font-size: 0.85em;
            }
            
            .quoted-thought-user-img {
                width: 20px;
                height: 20px;
                margin-right: 6px;
            }
            
            .quoted-thought-header {
                font-size: 0.8em;
            }
        }

        /* Theme Feedback Styling */
        .theme-feedback {
            position: fixed;
            top: 20px; /* Position from the top */
            left: 50%;
            transform: translateX(-50%); /* Center horizontally */
            background-color: var(--container-bg); /* Use theme background */
            color: var(--text-color); /* Use theme text color */
            padding: 10px 20px;
            border-radius: 20px; /* Rounded corners */
            border: 1px solid var(--border-color);
            box-shadow: 0 2px 8px rgba(0,0,0,0.15);
            font-size: 0.9em;
            z-index: 1001; /* Above lightbox overlay */
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.4s ease, visibility 0.4s ease, top 0.4s ease;
            white-space: nowrap;
        }
        .theme-feedback.visible {
            opacity: 1;
            visibility: visible;
            top: 30px; /* Slightly move down when visible */
        }

        /* Quoted thought styles */
        .quoted-thought-container {
            margin-top: 16px;
            position: relative;
            padding: 0;
        }
        
        .quoted-thought-box {
            border-left: 3px solid var(--secondary-text-color);
            background: linear-gradient(135deg, 
                rgba(128, 128, 128, 0.03) 0%, 
                rgba(128, 128, 128, 0.01) 100%);
            border-radius: 0 12px 12px 0;
            padding: 14px 16px;
            transition: all 0.2s ease;
            position: relative;
        }
        
        .quoted-thought-box:hover {
            background: linear-gradient(135deg, 
                rgba(128, 128, 128, 0.08) 0%, 
                rgba(128, 128, 128, 0.03) 100%);
            border-left-color: var(--text-color);
        }
        
        .quoted-thought-box::before {
            content: "";
            position: absolute;
            left: -3px;
            top: 0;
            bottom: 0;
            width: 3px;
            background: linear-gradient(to bottom, 
                var(--secondary-text-color) 0%, 
                transparent 100%);
            border-radius: 3px 0 0 3px;
        }
        
        .quoted-thought-header {
            display: flex;
            align-items: center;
            margin-bottom: 8px;
            gap: 8px;
        }
        
        .quoted-thought-user-img {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            flex-shrink: 0;
            opacity: 0.9;
        }
        
        .quoted-thought-user-info {
            display: flex;
            align-items: center;
            gap: 6px;
            min-width: 0;
        }
        
        .quoted-user-name {
            font-weight: 500;
            font-size: 1.1em;
            color: var(--text-color);
            line-height: 1.2;
            opacity: 0.85;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .quoted-thought-date-time {
            font-size: 0.72em;
            color: var(--secondary-text-color);
            line-height: 1.2;
            opacity: 0.8;
            white-space: nowrap;
        }
        
        .quoted-thought-permalink {
            color: inherit;
            text-decoration: none;
            transition: all 0.2s ease;
            border-radius: 3px;
            padding: 1px 3px;
            margin: -1px -3px;
        }
        
        .quoted-thought-permalink:hover {
            color: var(--text-color);
            background-color: rgba(128, 128, 128, 0.1);
            text-decoration: none;
        }
        
        .quoted-thought-content p {
            font-size: 0.95em;
            margin: 0;
            color: var(--text-color);
            opacity: 0.9;
        }
        
        .quoted-thought-image {
        }
        
        .quoted-thought-image img {
            max-width: 80%; /* Smaller than main thought images */
            max-height: 300px; /* Limit height to maintain proportions */
            width: auto;
            height: auto;
            border-radius: 8px;
            border: 1px solid rgba(128, 128, 128, 0.15);
            transition: border-color 0.2s ease;
            object-fit: cover;
        }
        
        .quoted-thought-image img:hover {
            border-color: var(--border-color);
        }

        /* Action Bar Styling */
        .thought-actions {
            padding-top: 8pt;
        }
        .action-row {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 6px; /* small gap without changing height */
        }
        .thread-links {
            display: flex;
            align-items: center;
            flex-wrap: nowrap;
            gap: 3px;
            min-height: 1.2em; /* one line high */
            min-width: 0; /* allow flex shrink for ellipsis */
            flex: 1 1 auto;
            color: var(--secondary-text-color);
            font-size: 0.9em;
            font-family: 'Literata', Georgia, serif; /* match reading surface */
            font-weight: 270;
            font-optical-sizing: auto;
            line-height: 1.2;
        }
        .thread-links-prefix { opacity: 0.9; margin-right: 2px; }
        .thread-chip {
            display: inline-block;
            padding: 0 5px; /* compact */
            border: 1px solid var(--soft-border-color);
            border-radius: 5px; /* rectangular with subtle rounding */
            color: var(--secondary-text-color);
            font-size: 0.85em;
            text-decoration: none;
            vertical-align: middle;
        }
        .thread-chip.primary {
            font-weight: 300;
            flex: 0 1 auto; /* allow shrink, but don't grow unnecessarily */
            width: max-content; /* size to text when space allows */
            max-width: 100%;   /* but never exceed available space */
            min-width: 0;      /* enable shrink inside flex */
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        .thread-chip.more { pointer-events: none; }
        .thread-chip:hover { background: var(--hover-bg-color); border-color: var(--border-color); color: var(--text-color); text-decoration: none; }

        .action-separator {
            height: 1px;
            background: repeating-linear-gradient(
                to right,
                var(--light-text-color) 0px,
                var(--light-text-color) 2px,
                transparent 2px,
                transparent 6px
            );
            margin-bottom: 2pt;
            opacity: 0.6;
        }

        .action-buttons {
            display: flex;
            justify-content: flex-end;
            align-items: center;
            flex: 0 0 auto; /* prevent growth; leave width to thread-links */
        }

        .share-button {
            background: transparent;
            border: none;
            font-size: 1.2em;
            cursor: pointer;
            padding: 0;
            border-radius: 4px;
            color: var(--secondary-text-color);
            transition: color 0.2s ease, transform 0.2s ease;
            font-family: inherit;
            outline: none;
            margin-right: 2pt;
            -webkit-tap-highlight-color: transparent;
            text-shadow: 0 0 1px rgba(0,0,0,0.5), 0 0 4px rgba(0,0,0,0.35);
        }

        .share-button:hover {
            color: var(--text-color);
            transform: scale(1.1);
        }

        .share-button:active {
            transform: scale(0.95);
            color: var(--text-color);
        }

        /* Share Feedback Toast */
        .share-feedback {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background-color: var(--text-color);
            color: var(--bg-color);
            padding: 12px 20px;
            border-radius: 6px;
            font-size: 0.9em;
            z-index: 1001;
            animation: slideUp 0.3s ease-out;
            max-width: 90%;
            text-align: center;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateX(-50%) translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateX(-50%) translateY(0);
            }
        }

        /* Mobile optimizations for action bar */
        @media (max-width: 600px) {
            .action-row { gap: 4px; }
            .thread-links { max-width: none; font-size: 0.9em; }
            .share-button {
                margin-right: 2pt;
                padding: 0;
                font-size: 1.3em;
            }
            .action-separator {
                margin-bottom: 2pt;
            }
            .thought-actions {
                padding-top: 8pt;
            }
        }

        .comment-button {
            background: transparent;
            border: none;
            font-size: 1.2em;
            cursor: pointer;
            padding: 0;
            border-radius: 4px;
            color: var(--secondary-text-color);
            transition: color 0.2s ease, transform 0.2s ease;
            font-family: inherit;
            outline: none;
            margin-right: 6pt; /* Extra gap before share icon */
            -webkit-tap-highlight-color: transparent;
            text-decoration: none;
            text-shadow: 0 0 0.5px rgba(0,0,0,0.5), 0 0 4px rgba(0,0,0,0.35);
        }

        .comment-button:hover {
            color: var(--text-color);
            transform: scale(1.1);
        }

        .comment-button:active {
            transform: scale(0.95);
            color: var(--text-color);
        }

    </style>

    <!-- Theme Feedback Element -->
    <div id="theme-feedback" class="theme-feedback" aria-live="polite"></div>

</head>
<body>
    <div class="container">
        <div class="profile-box">
    <div class="profile-content">
        <img src="https://illya.sh/staticthoughts/data/profile.png" alt="Illya Gerasymchuk profile photo" class="profile-img">
        <div class="profile-details">
            <div class="profile-name">Illya Gerasymchuk</div>
            <div class="profile-title">Financial & Software Engineer</div>
        </div>
    </div>
    <div class="profile-links">
        <a href="https://illya.sh/" target="_blank" title="About Illya Gerasymchuk (Homepage)" aria-label="About Illya Gerasymchuk (Homepage)">üè† About Illya</a><a href="https://illya.sh/threads/">üßµ Threads</a><a href="https://illya.sh/thoughts/topics/">üìÇ Topics</a><a href="mailto:hello@illya.sh" target="_blank">‚úâÔ∏è Email</a><a href="https://twitter.com/illyaGera" target="_blank">üê¶ Twitter/X</a><a href="https://illya.sh/thoughts/feed.xml" target="_blank">üì° RSS</a>
    </div>
</div>

        <h1 class="thoughts-header">MicroStrategy (MSTR) strategy &amp; equity analysis</h1>
<p class="threads-description" style="margin: -10px 0 25px 0; color: var(--secondary-text-color); text-align: center; font-size: 0.95em; line-height: 1.35;">Updates on MicroStrategy&#x27;s balance sheet, Bitcoin treasury, leverage, convertible debt and how the stock trades relative to spot BTC.</p>

<div class="thought-box">
    <div class="thought-header">
        <img src="https://illya.sh/staticthoughts/data/profile.png" alt="User" class="thought-user-img">
        <span class="user-name">Illya Gerasymchuk</span> -
        <p class="thought-date-time"><a href="../the-model-factory-has-been-refactored-to-use-a-dsl-for" class="thought-permalink">2026-02-24 12:55</a></p>
    </div>
    <div class="thought-content">
        <p>The model factory has been refactored to use a DSL for configuring the pipeline -- so now you can visualize and configure the whole flow from a single place<br><br>This also makes it easier for agents to autonomously discover and verify profitable trading strategies, but I&#x27;ll cover that in more detail in another post üòÅ</p>
        <div class="thought-image">
            <a href="https://illya.sh/staticthoughts/data/images/the-model-factory-has-been-refactored-to-use-a-dsl-for.jpg" class="lightbox-trigger"><img loading="lazy" src="https://illya.sh/staticthoughts/data/images/the-model-factory-has-been-refactored-to-use-a-dsl-for.jpg" alt="The model factory has been refactored to use a DSL for configuring the pipeline -- so now you can visualize and configure the whole flow..." class="thought-img"></a>
        </div>
        <div class="quoted-thought-container">
    <div class="quoted-thought-box">
        <div class="quoted-thought-header">
            <img src="https://illya.sh/staticthoughts/data/profile.png" alt="User" class="quoted-thought-user-img">
            <div class="quoted-thought-user-info">
                <span class="quoted-user-name">Illya Gerasymchuk</span>
                <span class="quoted-thought-date-time">
                    <a href="the-random-forests-features-have-been-heavily-refactored-i" class="quoted-thought-permalink">2026-02-20 16:51</a>
                </span>
            </div>
        </div>
        <div class="quoted-thought-content">
            <p>The random forest&#x27;s features have been heavily refactored. I also replaced the polymarket feature with lookahead bias (the proxy model) with a combination of other indicators.</p>
            <div class="quoted-thought-image"><a href="https://illya.sh/staticthoughts/data/images/the-random-forests-features-have-been-heavily-refactored-i.jpg" class="lightbox-trigger"><img loading="lazy" src="https://illya.sh/staticthoughts/data/images/the-random-forests-features-have-been-heavily-refactored-i.jpg" alt="The random forest&#x27;s features have been heavily refactored. I also replaced the polymarket feature with lookahead bias (the proxy model)..." class="quoted-thought-img"></a></div>
        </div>
    </div>
</div> 
    </div>
    <!-- Action Bar -->
    <div class="thought-actions">
        <div class="action-separator"></div>
        <div class="action-row">
            <div class="thread-links" aria-label="Related threads"><a class="thread-chip primary" href="https://illya.sh/threads/out-of-sample-permutation-feature-importance-for-random" target="_blank" rel="noopener" aria-label="Open Illya's thread: Out of Sample Permutation Feature Importance For Random Forest‚Äôs Feature Optimization">üßµ Out of Sample Permutation Feature Importance For Random Forest‚Äôs Feature Optimization</a></div>
            <div class="action-buttons">
                <a href="comment.html?id=the-model-factory-has-been-refactored-to-use-a-dsl-for" class="comment-button" aria-label="Comment on this thought">üí¨</a>
                <button class="share-button" data-share-url="https://illya.sh/thoughts/the-model-factory-has-been-refactored-to-use-a-dsl-for" data-share-title="" data-share-text="" aria-label="Share this thought">üì§</button>
            </div>
        </div>
    </div>
</div>


<div class="thought-box">
    <div class="thought-header">
        <img src="https://illya.sh/staticthoughts/data/profile.png" alt="User" class="thought-user-img">
        <span class="user-name">Illya Gerasymchuk</span> -
        <p class="thought-date-time"><a href="../a-primer-on-strategy-mstr-business-financials-liquidity-and" class="thought-permalink">2025-11-24 15:34</a></p>
    </div>
    <div class="thought-content">
        <p>A Primer On Strategy/MSTR Business, Financials, Liquidity and Solvency<br><br>There&#x27;s a lot of misinformation how Strategy/MicroStrategy operates, its business model and what MSTR can and can&#x27;t do.<br><br>This served as a motivation for me to write 4 short, primer-style articles on MSTR:<br><br>1Ô∏è‚É£ MSTR‚Äôs business model, describing how the company operates as a &quot;Bitcoin treasury&quot; and what does it mean for its solvency. You can read it here: <a href="https://illya.sh/threads/microstrategy-is-dependent-on-refinancing-capacity-not" target="_blank">https://illya.sh/threads/microstrategy-is-dependent-on-refinancing-capacity-not</a><br><br>2Ô∏è‚É£ Why MicroStrategy can‚Äôt replay its debt using equity/stock. You can read it here: <a href="https://illya.sh/threads/microstrategy-cant-repay-its-debt-in-equity-stock" target="_blank">https://illya.sh/threads/microstrategy-cant-repay-its-debt-in-equity-stock</a><br><br>3Ô∏è‚É£ How Strategy pays for its interest, which currently accounts to ‚âà$40M/year. You can read it here:  <a href="https://illya.sh/threads/how-microstrategy-pays-interest-on-its-debt" target="_blank">https://illya.sh/threads/how-microstrategy-pays-interest-on-its-debt</a><br> ¬†<br>4Ô∏è‚É£ How Strategy&#x27;s marketing is misleading regarding MSTR‚Äôs risk, liquidity and solvency. You can read it here: <a href="https://illya.sh/threads/strategy-invents-financial-metrics-and-everybody-applauds" target="_blank">https://illya.sh/threads/strategy-invents-financial-metrics-and-everybody-applauds</a><br><br>I suggest reading them in the same order as above, but they&#x27;re self-isolated. It&#x27;s a short read, and together they will give you a good understanding on how Strategy operates (its business model), what are its main risks, what MSTR can and cannot do regarding debt repayments, and why you probably shouldn‚Äôt trust their marketing campaigns, including the statements made by Michael Saylor on X and various podcasts/videos where he appears.</p>
        <div class="thought-image">
            <a href="https://illya.sh/staticthoughts/data/images/a-primer-on-strategy-mstr-business-financials-liquidity-and.jpg" class="lightbox-trigger"><img loading="lazy" src="https://illya.sh/staticthoughts/data/images/a-primer-on-strategy-mstr-business-financials-liquidity-and.jpg" alt="A Primer On Strategy/MSTR Business, Financials, Liquidity and Solvency" class="thought-img"></a>
        </div>
        
    </div>
    <!-- Action Bar -->
    <div class="thought-actions">
        <div class="action-separator"></div>
        <div class="action-row">
            <div class="thread-links" aria-label="Related threads"><a class="thread-chip primary" href="https://illya.sh/threads/a-primer-on-strategy-mstr-business-financials-liquidity-and" target="_blank" rel="noopener" aria-label="Open Illya's thread: A Primer On Strategy/MSTR Business, Financials, Liquidity and Solvency">üßµ A Primer On Strategy/MSTR Business, Financials, Liquidity and Solvency</a></div>
            <div class="action-buttons">
                <a href="comment.html?id=a-primer-on-strategy-mstr-business-financials-liquidity-and" class="comment-button" aria-label="Comment on this thought">üí¨</a>
                <button class="share-button" data-share-url="https://illya.sh/thoughts/a-primer-on-strategy-mstr-business-financials-liquidity-and" data-share-title="" data-share-text="" aria-label="Share this thought">üì§</button>
            </div>
        </div>
    </div>
</div>


<div class="thought-box">
    <div class="thought-header">
        <img src="https://illya.sh/staticthoughts/data/profile.png" alt="User" class="thought-user-img">
        <span class="user-name">Illya Gerasymchuk</span> -
        <p class="thought-date-time"><a href="../strategy-invents-financial-metrics-and-everybody-applauds" class="thought-permalink">2025-11-21 14:07</a></p>
    </div>
    <div class="thought-content">
        <p>Strategy Invents Financial Metrics And Everybody Applauds üëè<br><br>MSTR&#x27;s own website states that their reports do not reflect the financial reality:<br><br>&quot;None of BTC Rating, BTC Credit, or BTC Risk are measures of financial results or liquidity, or key performance indicators.&quot;<br><br>Strategy&#x27;s software business also operates at a ‚âà$60M loss, but on their website and socials they decide to ignore a part of expenses and market it as profit. So they create their own non-standard accounting and credit metrics and advertise those.<br><br>Strategy has a consistent pattern of misrepresenting their financials to look more favorable in their public marketing campaigns. A lot of it is in the form of Michael Saylor&#x27;s videos, podcast appearances and posts on X. A lot seem to think that just because someone says something in a video or a social media post it must be true. <br><br>Words can be deceiving, numbers not so much.</p>
        <div class="thought-image">
            <a href="https://illya.sh/staticthoughts/data/images/strategy-invents-financial-metrics-and-everybody-applauds.jpg" class="lightbox-trigger"><img loading="lazy" src="https://illya.sh/staticthoughts/data/images/strategy-invents-financial-metrics-and-everybody-applauds.jpg" alt="Strategy Invents Financial Metrics And Everybody Applauds üëè" class="thought-img"></a>
        </div>
        
    </div>
    <!-- Action Bar -->
    <div class="thought-actions">
        <div class="action-separator"></div>
        <div class="action-row">
            <div class="thread-links" aria-label="Related threads"><a class="thread-chip primary" href="https://illya.sh/threads/strategy-invents-financial-metrics-and-everybody-applauds" target="_blank" rel="noopener" aria-label="Open Illya's thread: Strategy Invents Financial Metrics And Everybody Applauds üëè">üßµ Strategy Invents Financial Metrics And Everybody Applauds üëè</a></div>
            <div class="action-buttons">
                <a href="comment.html?id=strategy-invents-financial-metrics-and-everybody-applauds" class="comment-button" aria-label="Comment on this thought">üí¨</a>
                <button class="share-button" data-share-url="https://illya.sh/thoughts/strategy-invents-financial-metrics-and-everybody-applauds" data-share-title="" data-share-text="" aria-label="Share this thought">üì§</button>
            </div>
        </div>
    </div>
</div>


<div class="thought-box">
    <div class="thought-header">
        <img src="https://illya.sh/staticthoughts/data/profile.png" alt="User" class="thought-user-img">
        <span class="user-name">Illya Gerasymchuk</span> -
        <p class="thought-date-time"><a href="../how-microstrategy-pays-interest-on-its-debt" class="thought-permalink">2025-11-20 08:56</a></p>
    </div>
    <div class="thought-content">
        <p>How MicroStrategy Pays Interest On Its Debt?<br><br>The short answer is that MSTR finances its debt service via a mixture of:<br><br>‚ûñ Software business cashflow<br>‚ûñ Existing reserves &amp; short-term investments<br>‚ûñ Capital market instruments, such as issuing new equity or debt<br>‚ûñ Asset liquidation (Bitcoin sales)<br><br>MSTR&#x27;s annual coupon payments sum up to ‚âà$34.6M/year. Currently, virtually all of MSTR&#x27;s financial debt is in convertible bonds/senior notes. Those bonds come with small coupons, so relatively small interest payments.<br><br>More specifically, here is how MicroStrategy&#x27;s/Strategy&#x27;s outstanding outstanding convertible bond maturity, principal, coupon rate and total yearly interest  look like:<br><br>2028     | $1.01B   @ 0.625%   | $6.3M<br>2029     | $3.0B    @ 0%            | $0M<br>2030A  | $0.8B     @ 0.625%  | $5M<br>2030B  | $2.0B     @ 0%           | $0M<br>2031     | $0.604B @ 0.875%  | $5.3M<br>2032    | $0.8B       @ 2.25%     | $18M<br><br>(Format: &lt;year&gt; | &lt;principal&gt; @ &lt;coupon&gt; | &lt;anual interest&gt;)<br><br>If you sum up the interest payments you‚Äôll get ‚âà$34.6M/year in total.<br><br>The yearly revenue of MSTR&#x27;s software services business is almost ‚âà$500M/year. However, their software portion of the business actually operates at ‚âà60M/year loss, when using U.S. Generally Accepted Accounting Principles (GAAP).<br><br>Strategy advertises their software portion of the business as being in profit, but they &quot;manipulate&quot; those numbers a little. This &quot;manipulation&quot; involves MSTR not counting stock-based compensation as expenses.<br><br>So when you hear Strategy advertising profit from their software business - they&#x27;re not using a legally recognized and standardized measure of profit (in the U.S. it&#x27;s GAAP). So they take the GAAP software profit and then add some things back at their discretion (i.e. they don&#x27;t count some expenses), thus turning a negative profit (loss) into a positive one.<br><br>This means that while their software business revenue can help them with having liquidity for interest payments - it doesn&#x27;t cover those costs (since they operate at loss, it actually increases the total cost!).<br><br>Thus, Strategy finances their interest rate payments with a mixture of:<br><br>‚ûñ Existing reserves &amp; short-term investments<br>‚ûñ Capital market instruments, such as issuing new equity or debt (main source)<br>‚ûñ Asset liquidation<br><br>The software revenue provides significant cashflow (compared to interest rate costs), so it can help with having cash readily available to make an interest payment (liquidity), but it doesn&#x27;t effectively cover them, thus requiring financing from other sources.</p>
        <div class="thought-image">
            <a href="https://illya.sh/staticthoughts/data/images/how-microstrategy-pays-interest-on-its-debt.jpg" class="lightbox-trigger"><img loading="lazy" src="https://illya.sh/staticthoughts/data/images/how-microstrategy-pays-interest-on-its-debt.jpg" alt="How MicroStrategy Pays Interest On Its Debt?" class="thought-img"></a>
        </div>
        
    </div>
    <!-- Action Bar -->
    <div class="thought-actions">
        <div class="action-separator"></div>
        <div class="action-row">
            <div class="thread-links" aria-label="Related threads"><a class="thread-chip primary" href="https://illya.sh/threads/how-microstrategy-pays-interest-on-its-debt" target="_blank" rel="noopener" aria-label="Open Illya's thread: How MicroStrategy Pays Interest On Its Debt?">üßµ How MicroStrategy Pays Interest On Its Debt?</a></div>
            <div class="action-buttons">
                <a href="comment.html?id=how-microstrategy-pays-interest-on-its-debt" class="comment-button" aria-label="Comment on this thought">üí¨</a>
                <button class="share-button" data-share-url="https://illya.sh/thoughts/how-microstrategy-pays-interest-on-its-debt" data-share-title="" data-share-text="" aria-label="Share this thought">üì§</button>
            </div>
        </div>
    </div>
</div>


<div class="thought-box">
    <div class="thought-header">
        <img src="https://illya.sh/staticthoughts/data/profile.png" alt="User" class="thought-user-img">
        <span class="user-name">Illya Gerasymchuk</span> -
        <p class="thought-date-time"><a href="../strategy-mstr-pays-interest-on-its-debt-via-a-mixture-of" class="thought-permalink">2025-11-18 14:54</a></p>
    </div>
    <div class="thought-content">
        <p>Strategy (MSTR) pays interest on its debt via a mixture of capital markets, software business cashflow, existing reserves &amp; investments and Bitcoin sales.<br><br>MSTR&#x27;s annual coupon payments are not that high - ‚âà$40M/year. The convertible bonds that they issue come with small coupons (e.g. 0%, 0.625%, %0.875, 2.25%)<br><br>Given MSTR&#x27;s software business revenue of ‚âà$500M/year, but it actually operates at a ‚âà$60M loss after expenses are accounted for.<br><br>So effectively, strategy pays interest expenses from the same corporate funds bucket that they rase to purchase Bitcoin in capital markets.</p>
        <div class="thought-image">
            
        </div>
        
    </div>
    <!-- Action Bar -->
    <div class="thought-actions">
        <div class="action-separator"></div>
        <div class="action-row">
            <div class="thread-links" aria-label="Related threads"><a class="thread-chip primary" href="https://illya.sh/threads/strategy-mstr-pays-interest-on-its-debt-via-a-mixture-of" target="_blank" rel="noopener" aria-label="Open Illya's thread: Strategy (MSTR) pays interest on its debt via a mixture of capital markets, software business cashflow, existing reserves &amp; investments and Bitcoin sales.">üßµ Strategy (MSTR) pays interest on its debt via a mixture of capital markets, software business cashflow, existing reserves &amp; investments and Bitcoin sales.</a></div>
            <div class="action-buttons">
                <a href="comment.html?id=strategy-mstr-pays-interest-on-its-debt-via-a-mixture-of" class="comment-button" aria-label="Comment on this thought">üí¨</a>
                <button class="share-button" data-share-url="https://illya.sh/thoughts/strategy-mstr-pays-interest-on-its-debt-via-a-mixture-of" data-share-title="" data-share-text="" aria-label="Share this thought">üì§</button>
            </div>
        </div>
    </div>
</div>


<div class="thought-box">
    <div class="thought-header">
        <img src="https://illya.sh/staticthoughts/data/profile.png" alt="User" class="thought-user-img">
        <span class="user-name">Illya Gerasymchuk</span> -
        <p class="thought-date-time"><a href="../microstrategy-cant-repay-its-debt-in-equity-stock" class="thought-permalink">2025-11-16 23:01</a></p>
    </div>
    <div class="thought-content">
        <p>MicroStrategy Can&#x27;t Repay Its Debt In Equity/Stock<br><br>Most of MicroStrategy&#x27;s debt is in the form of convertible bonds, meaning that by default the principal and the coupons get repaid the cash. <br><br>The &quot;convertible&quot; part means the bondholder can choose to convert the bond into shares/equity instead, and then MSTR chooses how settle the conversion of the bond&#x27;s value in cash, equity or mix.<br><br>So MSTR cannot force the debt settlement/repayment in stock/equity - that&#x27;s simply an option that the bondholders/investors have. <br><br>The repayment can always be in cash assuming that MSTR is solvent, as most of the debt is unsecured, meaning that there is no specific collateral pledged against that debt. In case of insolvency, unsecured debt holders are treated as general creditors of the company, and are repaid out of the remaining assets only after secured debt holders are repaid, but before equity holders.</p>
        <div class="thought-image">
            <a href="https://illya.sh/staticthoughts/data/images/microstrategy-cant-repay-its-debt-in-equity-stock.jpg" class="lightbox-trigger"><img loading="lazy" src="https://illya.sh/staticthoughts/data/images/microstrategy-cant-repay-its-debt-in-equity-stock.jpg" alt="MicroStrategy Can&#x27;t Repay Its Debt In Equity/Stock" class="thought-img"></a>
        </div>
        
    </div>
    <!-- Action Bar -->
    <div class="thought-actions">
        <div class="action-separator"></div>
        <div class="action-row">
            <div class="thread-links" aria-label="Related threads"><a class="thread-chip primary" href="https://illya.sh/threads/microstrategy-cant-repay-its-debt-in-equity-stock" target="_blank" rel="noopener" aria-label="Open Illya's thread: MicroStrategy Can&#x27;t Repay Its Debt In Equity/Stock">üßµ MicroStrategy Can&#x27;t Repay Its Debt In Equity/Stock</a></div>
            <div class="action-buttons">
                <a href="comment.html?id=microstrategy-cant-repay-its-debt-in-equity-stock" class="comment-button" aria-label="Comment on this thought">üí¨</a>
                <button class="share-button" data-share-url="https://illya.sh/thoughts/microstrategy-cant-repay-its-debt-in-equity-stock" data-share-title="" data-share-text="" aria-label="Share this thought">üì§</button>
            </div>
        </div>
    </div>
</div>


<div class="thought-box">
    <div class="thought-header">
        <img src="https://illya.sh/staticthoughts/data/profile.png" alt="User" class="thought-user-img">
        <span class="user-name">Illya Gerasymchuk</span> -
        <p class="thought-date-time"><a href="../microstrategy-is-dependent-on-refinancing-capacity-not" class="thought-permalink">2025-11-16 16:41</a></p>
    </div>
    <div class="thought-content">
        <p>MicroStrategy Is Dependent On Refinancing Capacity, Not Bitcoin Price<br><br>MSTR won&#x27;t have to sell Bitcoin if BTC price goes down, they&#x27;ll have to sell Bitcoin if they&#x27;re unable to acquire funding along the maturity of their debt wall. <br><br>MicroStrategy is essentially a leveraged trade on Bitcoin, based on the following cycle:<br><br>1Ô∏è‚É£ Acquire funding via debt or equity<br>2Ô∏è‚É£ Buy Bitcoin<br>3Ô∏è‚É£ Repeat<br><br>This cycle works for as long as MSTR is able to obtain funding. Once funding becomes unavailable (i.e. market isn&#x27;t willing to lend at favorable interest rates), funding must come from asset liquidation (i.e. the sale of Bitcoin).<br><br>The availability of funding is mostly dependent on Bitcoin&#x27;s price. As long as Bitcoin price and trend is favorable around the dates when the debt wall matures - MSTR should be able to continue their leveraged trade. MSTR share price vs Bitcoin NAV is also important. If MSTR trades a premium over Bitcoin&#x27;s NAV it allows Microstrategy to short their own equity and long Bitcoin.<br><br>However, an unfavorable Bitcoin price action environment (e.g. during a bear market) that coincides with debt repayment obligations may trigger the unwinding of this leveraged position, forcing MSTR to sell Bitcoin, thus putting further downwards price pressure on Bitcoin, which lowers Microstrategy&#x27;s equity even more, which makes lender even less likely to lend. The end result is an even more degraded funding capacity, which at the limit leads to bankruptcy.<br><br>Debt starts maturing from 2028 (‚âà$1B), but the most significant portion of ‚âà70%/$5.8B matures in 2029-2030. This is where the price of Bitcoin is of great importance for Microstrategy&#x27;s solvency.<br><br>So don&#x27;t expect Microstrategy to have pressure to sell significant amounts of Bitcoin before at least 2027, even if the Bitcoin price stays low.</p>
        <div class="thought-image">
            <a href="https://illya.sh/staticthoughts/data/images/microstrategy-is-dependent-on-refinancing-capacity-not.jpg" class="lightbox-trigger"><img loading="lazy" src="https://illya.sh/staticthoughts/data/images/microstrategy-is-dependent-on-refinancing-capacity-not.jpg" alt="MicroStrategy Is Dependent On Refinancing Capacity, Not Bitcoin Price" class="thought-img"></a>
        </div>
        
    </div>
    <!-- Action Bar -->
    <div class="thought-actions">
        <div class="action-separator"></div>
        <div class="action-row">
            <div class="thread-links" aria-label="Related threads"><a class="thread-chip primary" href="https://illya.sh/threads/microstrategy-is-dependent-on-refinancing-capacity-not" target="_blank" rel="noopener" aria-label="Open Illya's thread: MicroStrategy Is Dependent On Refinancing Capacity, Not Bitcoin Price">üßµ MicroStrategy Is Dependent On Refinancing Capacity, Not Bitcoin Price</a></div>
            <div class="action-buttons">
                <a href="comment.html?id=microstrategy-is-dependent-on-refinancing-capacity-not" class="comment-button" aria-label="Comment on this thought">üí¨</a>
                <button class="share-button" data-share-url="https://illya.sh/thoughts/microstrategy-is-dependent-on-refinancing-capacity-not" data-share-title="" data-share-text="" aria-label="Share this thought">üì§</button>
            </div>
        </div>
    </div>
</div>


<div class="thought-box">
    <div class="thought-header">
        <img src="https://illya.sh/staticthoughts/data/profile.png" alt="User" class="thought-user-img">
        <span class="user-name">Illya Gerasymchuk</span> -
        <p class="thought-date-time"><a href="../michael-saylor-doesnt-need-to-expose-mstrs-wallets-for-a" class="thought-permalink">2025-05-27 14:55</a></p>
    </div>
    <div class="thought-content">
        <p>Michael Saylor doesn&#x27;t need to expose MSTR&#x27;s wallets for a proof of reserves<br><br>All you need is Zero Knowledge Proof attesting that MicroStrategy has access to private key(s) holding a total of X BTC  <br><br>With ZKPs - no Bitcoin addresses are exposed ‚ú®</p>
        <div class="thought-image">
            
        </div>
        
    </div>
    <!-- Action Bar -->
    <div class="thought-actions">
        <div class="action-separator"></div>
        <div class="action-row">
            <div class="thread-links" aria-label="Related threads"></div>
            <div class="action-buttons">
                <a href="comment.html?id=michael-saylor-doesnt-need-to-expose-mstrs-wallets-for-a" class="comment-button" aria-label="Comment on this thought">üí¨</a>
                <button class="share-button" data-share-url="https://illya.sh/thoughts/michael-saylor-doesnt-need-to-expose-mstrs-wallets-for-a" data-share-title="" data-share-text="" aria-label="Share this thought">üì§</button>
            </div>
        </div>
    </div>
</div>

        
        
    </div>

    <!-- Lightbox Structure (Initially Hidden) -->
    <div id="lightbox" class="lightbox-overlay">
        <div class="lightbox-content">
            <button class="lightbox-close" aria-label="Close">&times;</button>
            <img src="" alt="Lightbox image">
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const lightbox = document.getElementById('lightbox');
            const lightboxImg = lightbox.querySelector('img');
            const lightboxClose = lightbox.querySelector('.lightbox-close');
            const triggers = document.querySelectorAll('.lightbox-trigger');

            triggers.forEach(trigger => {
                trigger.addEventListener('click', (e) => {
                    e.preventDefault(); // Prevent default link behavior
                    const imgSrc = trigger.getAttribute('href');
                    lightboxImg.setAttribute('src', imgSrc);
                    lightbox.classList.add('visible');
                    document.body.style.overflow = 'hidden'; // Prevent scrolling background
                });
            });

            // Check if we're on an individual thought page (robust across URL modes)
            const isIndividualThoughtPage = !!document.querySelector('.individual-thought-navigation');
            
            // Handle quoted thought box clicks for navigation (always clickable)
            const quotedThoughts = document.querySelectorAll('.quoted-thought-box');
            quotedThoughts.forEach(quotedBox => {
                quotedBox.addEventListener('click', (e) => {
                    // Don't navigate if clicking on an image or link within the quoted thought
                    if (e.target.tagName === 'IMG' || e.target.tagName === 'A') {
                        return;
                    }
                    e.preventDefault();
                    // Find the permalink within this quoted thought
                    const permalink = quotedBox.querySelector('.quoted-thought-permalink');
                    if (permalink) {
                        window.location.href = permalink.getAttribute('href');
                    }
                });
                
                // Add cursor pointer to indicate clickability
                quotedBox.style.cursor = 'pointer';
            });

            // Handle main thought box clicks (only in timeline/list views, not on individual pages)
            if (!isIndividualThoughtPage) {
                const mainThoughts = document.querySelectorAll('.thought-box');
                mainThoughts.forEach(thoughtBox => {
                    // Skip if this is a quoted thought box (already handled above)
                    if (thoughtBox.closest('.quoted-thought-container')) {
                        return;
                    }
                    
                    thoughtBox.addEventListener('click', (e) => {
                        // Don't navigate if clicking on an image, link, quoted thought, or action buttons within the main thought
                        if (e.target.tagName === 'IMG' || 
                            e.target.tagName === 'A' || 
                            e.target.closest('.quoted-thought-container') ||
                            e.target.closest('.thought-actions')) {
                            return;
                        }
                        e.preventDefault();
                        // Find the permalink within this main thought
                        const permalink = thoughtBox.querySelector('.thought-permalink');
                        if (permalink) {
                            window.location.href = permalink.getAttribute('href');
                        }
                    });
                    
                    // Add cursor pointer and clickable class to indicate clickability
                    thoughtBox.style.cursor = 'pointer';
                    thoughtBox.classList.add('clickable');
                });
            }

            // --- Share button logic with single vs double-click ---
            const shareButtons = document.querySelectorAll('.share-button');
            const DOUBLE_THRESHOLD = 500; // ms

            shareButtons.forEach(btn => {
                let clickTimer = null;
                btn.addEventListener('click', (e) => {
                    e.preventDefault();
                    e.stopPropagation();

                    const shareData = {
                        title: btn.dataset.shareTitle,
                        text: btn.dataset.shareText,
                        url: btn.dataset.shareUrl
                    };

                    // If this is the second click within threshold ‚Üí double-click
                    if (clickTimer) {
                        clearTimeout(clickTimer);
                        clickTimer = null;
                        performCopy(shareData.url); // Double-click action
                        return;
                    }

                    // First click ‚Äì set up timer for single-click action
                    clickTimer = setTimeout(() => {
                        clickTimer = null;
                        showNativeShare(shareData);
                    }, DOUBLE_THRESHOLD);
                });
            });

            async function showNativeShare(shareData) {
                if (navigator.share) {
                    try {
                        await navigator.share(shareData);
                        return;
                    } catch (err) {
                        // Ignore user cancellation; fallback otherwise
                        if (!err || (err.name !== 'AbortError' && err.name !== 'NotAllowedError')) {
                            performCopy(shareData.url);
                        }
                        return;
                    }
                }
                performCopy(shareData.url); // Fallback when Web Share not available
            }

            function performCopy(url) {
                if (navigator.clipboard && navigator.clipboard.writeText) {
                    navigator.clipboard.writeText(url).then(() => {
                        toast('Link copied to clipboard! üìã');
                    }).catch(() => {
                        toast('Copy this link: ' + url);
                    });
                } else {
                    toast('Copy this link: ' + url);
                }
            }

            // Simple toast helper
            function toast(msg) {
                const old = document.querySelector('.share-feedback');
                if (old) old.remove();
                const el = document.createElement('div');
                el.className = 'share-feedback';
                el.textContent = msg;
                document.body.appendChild(el);
                setTimeout(() => el.remove(), 3000);
            }

            function closeLightbox() {
                lightbox.classList.remove('visible');
                lightboxImg.setAttribute('src', ''); // Clear image src
                document.body.style.overflow = ''; // Restore scrolling
            }

            // Close on button click
            lightboxClose.addEventListener('click', closeLightbox);

            // Close on clicking overlay background
            lightbox.addEventListener('click', (e) => {
                if (e.target === lightbox) { // Only close if overlay itself is clicked
                    closeLightbox();
                }
            });

            // Close on Escape key press
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape' && lightbox.classList.contains('visible')) {
                    closeLightbox();
                }
            });
        });
    </script>

    <script>
        // Dark Mode Toggle Logic
        document.addEventListener('DOMContentLoaded', () => {
            const body = document.body;
            const profileImg = document.querySelector('.profile-img');
            const feedbackElement = document.getElementById('theme-feedback');
            const themeLocalStorageKey = 'themePreference'; // Stores 'auto', 'light', or 'dark'
            let feedbackTimeout;

            function applyTheme(theme) {
                // Remove specific mode classes first
                body.classList.remove('light-mode', 'dark-mode');
                let actualTheme = theme;

                if (theme === 'auto') {
                    // Check system preference if auto
                    const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
                    actualTheme = prefersDark ? 'dark' : 'light';
                } 

                // Apply the determined theme class
                if (actualTheme === 'dark') {
                    body.classList.add('dark-mode');
                } else {
                    body.classList.add('light-mode'); 
                }
            }

            function showFeedback(message) {
                if (!feedbackElement) return;
                
                // Clear any existing timeout to prevent overlap
                if (feedbackTimeout) {
                    clearTimeout(feedbackTimeout);
                }

                feedbackElement.innerHTML = message;
                feedbackElement.classList.add('visible');

                // Hide feedback after a delay
                feedbackTimeout = setTimeout(() => {
                    feedbackElement.classList.remove('visible');
                }, 1700); // 1.7 seconds
            }

            function setThemePreference(theme) {
                localStorage.setItem(themeLocalStorageKey, theme);
                applyTheme(theme);
                // Show feedback based on the *newly set* preference
                let feedbackMessage = '';
                if (theme === 'light') {
                    feedbackMessage = 'üí° Light Mode Activated';
                } else if (theme === 'dark') {
                    feedbackMessage = 'üåô Dark Mode Activated';
                } else {
                    feedbackMessage = '‚öôÔ∏è Auto Mode Activated';
                }
                 showFeedback(feedbackMessage);
            }

            function cycleTheme() {
                const currentPreference = localStorage.getItem(themeLocalStorageKey) || 'auto'; // Default to auto
                let nextPreference;

                if (currentPreference === 'auto') {
                    nextPreference = 'light';
                } else if (currentPreference === 'light') {
                    nextPreference = 'dark';
                } else { // currentPreference === 'dark'
                    nextPreference = 'auto';
                }
                setThemePreference(nextPreference);
            }

            // Set initial theme
            const savedTheme = localStorage.getItem(themeLocalStorageKey) || 'auto'; // Default to auto
            applyTheme(savedTheme);

            // Add click listener to profile image
            if (profileImg) {
                profileImg.addEventListener('click', cycleTheme);
            }

             // Listen for system theme changes
             window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
                 // Only apply change if the current preference is 'auto'
                 if (localStorage.getItem(themeLocalStorageKey) === 'auto' || !localStorage.getItem(themeLocalStorageKey)) {
                     applyTheme('auto'); // Re-apply auto theme to respect the change
                 }
             });
        });
    </script>

</body>
</html>
